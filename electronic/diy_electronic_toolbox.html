<!DOCTYPE html>
<html lang="fr">
<head>
<meta name="generator" content=
"HTML Tidy for HTML5 for Linux/x86 version 5.1.40">
<meta name="Electronic DIY toolbox" content=
"Electronic DIY toolbox">
<meta charset="utf-8">
<title>Electronic DIY toolbox</title>
<style>
body{
	background-color:#FCF8EA;
	font-family:sans-serif;
}
article{
	display:inline-block;
}
#corps{
	display:inline-block;
	text-align:center;
	width:100%;
}
.app{
	display:none;
	width:80%;
	position:absolute;
	left:2%;
}
.app ul{
	text-align:left;
}
app header h3{
	text-align:center;
	background-color:rgba(173,173,173,0.25);
	font-size:small;
	margin:0;
}
#titre{
	position : relative;
	top:0;
	left:0;
	width:100%;
}
.cadre{
	display:inline-block;
	text-align:center;
}
/* Block de calcul des combinaisons de resistance */
.stock{
}
.formule{
	width: 40%;
}
.valeur{
	width: 10%;
}
footer {
	position:fixed;
	top:97%;
	bottom:auto;
	font-size: small;
	color: #D1D1D1;
	background-color:black;
	width:100%;
}
footer:hover {
	bottom:0;
	top:auto;
}
footer div{
	display:inline-block;
	margin-left:2vw;
	width:47%;
}
footer a{
	font-size: 1em;
	color:green;
	padding:0.5em;
	margin:0.5em;
	border:2px solid green;
}
footer a:hover{
	color:#90EE90;
	border:2px solid #90EE90;
}
footer ul{
	list-style:none;text-align:right;
}
footer ul li {
	margin-top:1.5em;
}
.block_stock {
	position:relative;
	display:inline-block;
}
.block_stock .title{
	left:20%;
}
.block_stock input{
	width:99%;
}
.block_form0 .title{
	left:10%;
	text-align:left;
}
.block_form0 .view{
	position:relative;
	left:20%;
}
.mixed_input{
	padding:1em;
}
.mixed_input input{
	border:none;
}
.block_form0 input{
	margin:0;
	padding:0;
}
.block_form1 {
	position:relative;
	text-align:left;
}
.block_form1 button{
	position:absolute;
	left:60%;
}
.block_form1 input{
	position:absolute;
	left:60%;
	width:10em;
}
.block_form2 {
	position:relative;
	left:10%;
	text-align:left;
	color:#2D2D2D;
}
.block_form2 input{
	position:relative;
	width:16em;
}
/*Les boutons */
button{
	border: 1.5px solid gray;
	background-color:white;
	cursor:default;
	min-width:1.75em;
}
button:active{
	transform: translate(-5px,0px);
	-webkit-transform: translate(-5px,0px);
	-ms-transform: translate(-5px,0px);
}
button:hover{
	border: 1.5px solid black;
	background-color:#40FF40;
	cursor:pointer;
}
.button_waiting{
	cursor:wait !important;
	background-color:gray;
}
.button_hidden{
	display:none;
}
.button_deprecated{
	background-color:gray;
	border: 1.5px solid black;
	color:white;
}
.button_deprecated:hover{
	border: 1.5px solid black;
	background-color:red;
	cursor:pointer;
}
.button_disabled{
	background-color:gray;
	border: 1.5px solid gray;
	opacity:0.1;
}
.button_disabled:hover{
	background-color:gray;
}
.button_waiting:hover{
	cursor:wait !important;
	background-color:gray;
}
/* Block de déchiffrage d'une résistance */
.resistor_block {
	display:inline;
	border-bottom:1px solid black;
	text-align:left;
	width:100%;
	display:none;
}
#resistor_settings {
	display:inline-block;
	padding:0.2em;
	max-width:40em;
	text-align:left;
}
#resistor_settings .cei_color_list{
	text-align:center;
}
.resistor_prop_title .info{
	font-weight:normal;
}
.resistor_prop_title{
	list-style-type: none;
	padding-left:0.5em;
	padding-right:0.5em;
	border: none;
	font-weight:bold;
	font-size:small;
	text-align:center;
}
.cei_color_block { 
	display: block;
	margin: 0;
	padding: 0;
	float:left;
}
.cei_color_block ul{
	display: inline-block;
	margin: 0;
	padding: 0;
	float:left;
}
.cei_color_block li{ 
	list-style-type: none;
	border : 1px solid black;
	margin: 1.5px;
	min-width:1.2em;
	text-align:center;
	font-size:small;
	cursor:pointer;
	opacity:0.7;
}
.cei_color_block li:hover {
	opacity:1;
}
.cei_color_list { 
	display: inline-block;
	margin: 0;
	padding: 0;
	float:left;
}
.cei_color_list li {
	list-style-type: none;
	border : 1px solid black;
	margin: 2px;
	min-width:1.5em;
	text-align:center;
	font-size:small;
	border-radius: 0.2em;
	cursor:pointer;
	opacity:0.7;
}
.cei_color_list li:hover {
	opacity:1;
}
.font-small li{
	font-size:x-small;
	padding:0.1em;
}
#resistor_settings  article{
	display:inline-block;
}
#resistor_settings  div + ul li{
	font-size:large;
}
.underlined{
	border-bottom : 1px solid black;
}
.highlight{
	background: white;
}


.resistor_desc { 
	margin: 0;
	padding: 0;
	float:left;
	text-align:left;
	width:100%;
}

.resistor_mode_list ul { 
	margin: 0;
	padding: 0;
	float:left;
	text-align:left;
	width:100%;
	font-size:small;
}

.resistor_mode_list li {
	list-style-type: none;
	padding-left:0.2em;
	display: inline-block;
	padding-right:0.2em;
	text-align:center;
	border : 1px solid grey;
	cursor:pointer;
	min-width:1em;
	opacity:0.7;
}
.resistor_mode_list li:hover {
	opacity:1;
}
.resistor_mode_list .active,#pow .active{
	opacity:1;
	font-weight:bold;
	border : 3px solid #4D4D4D;
}
.resistor_mode_list .title{
	border : none;
	display: inline;
}

.resistor_value_selector{
	opacity:0.7;
	display:inline-block;
	float:left;
	border: 1px solid #DCDFCC;
	margin:1px;
}
.resistor_value_selector:hover{
	opacity:1;
	border: 2px solid black;
}
.resistor_value_selector .active{
	opacity:1;
	font-weight:bold;
	border : 2px solid #000000;
	border-radius : 0.5em ;
}
.resistor_value_selector li{
	margin:1px;
}
#pow li{
	width:2.5em;
}
#tol li{
	width:2em;
}
#mult li {
	width:2.5em;
}
.cei_color_Black{ background-color: black ; color: white; border: 1px solid black; -moz-user-select: none;}
.cei_color_Brown{ background-color: brown ; border: 1px solid black;-moz-user-select: none;}
.cei_color_Red{ background-color: red; border: 1px solid black;-moz-user-select: none;}
.cei_color_Orange{ background-color: #FF7000; border: 1px solid black; -moz-user-select: none;}
.cei_color_Yellow{ background-color: yellow; border: 1px solid black; -moz-user-select: none;}
.cei_color_Green{ background-color: green; color: white;border: 1px solid black; -moz-user-select: none;}
.cei_color_Blue{ background-color: blue; color: white;border: 1px solid black; -moz-user-select: none;}
.cei_color_Violet{ background-color: violet; border: 1px solid black; -moz-user-select: none;}
.cei_color_Gray{ background-color: gray; border: 1px solid black; -moz-user-select: none;}
.cei_color_White{ background-color: white; border: 1px solid black; -moz-user-select: none;}
.cei_color_Gold{ background-color: gold; border: 1px solid black; -moz-user-select: none;}
.cei_color_Silver{ background-color: silver; border: 1px solid black; -moz-user-select: none;}
.cei_color_None{ background-color: rgba(0,0,0,0.0); border: 1px solid rgba(0,0,0,0); -moz-user-select: none; }
.cei_color_Transparent{ background-color: rgba(175,175,175,0.2); border: 1px solid rgba(175,175,175,0.1) ; -moz-user-select: none; }
.cei_color_Beige{ background-color: #FFFFAD ; -moz-user-select: none;}
.cei_color_Cyan{ background-color: #1E90FF; -moz-user-select: none;}
.cei_color_Pink{ background-color: #FF778F ; -moz-user-select: none;}
.cei_color_CapGreen{ background-color: #90EE90 ; -moz-user-select: none;}
.ceramic_color_Brown{ background-color: #FFA500; -moz-user-select: none; }
.resistor_blink_val{ display:inline-block;border: 2px solid rgba(0,255,0,0.9) ; -moz-user-select: none; }
.resistor_blink_val_hidden{ display:inline-block;border: 2px solid rgba(255,255,0,0) ; -moz-user-select: none; }

/*Image/aperçue de la résistance*/
.resistor_view_canvas{
	display:inline-block;
	text-align:center;
	border: 1px dashed gray;
	background-color:rgba(255,255,255,0.25);
	padding:0.5em;
	margin:0.25em;
}
.resistor_view_canvas_resistor_small{
	border: 1px dashed gray;
	background-color:rgba(255,255,255,0.25);
	margin:0.5em;
	padding:0em;
}
.resistor_view_canvas_resistor_small .resistor_view{
	color:red;
	margin-top:1em;
}
.resistor_view_canvas input{
	background-color:rgba(255,255,255,0);
	border:none;
}
.resistor_view{
	border:2px solid black;
	box-shadow: 2px 2px 5px #888888;
	border-radius:0.25em;
}
.power_resistor_view{
	border:2px solid yellow;
	background-color: gold;
	box-shadow: 2px 2px 5px #888888;
}
.eletrolytic_pkg_view_round{
	border-radius:10em;
	margin:0;
	padding:0;
}
.eletrolytic_pkg_view_cylinder input {
	font-size:0.5em;
	margin-top:1em;
	margin-bottom:1em;
	padding:0;
	border:none;
}
.eletrolytic_pkg_view_cylinder{
	border-radius:10em;
	margin:0;
	padding:0;
	box-shadow: 5px 1px 5px rgba(136,136,136,0.5);
}
.plastic_pkg_view{
	box-shadow: 2px 2px 5px #888888;
	min-width:4em;
}
.resistor_small{
	font-size:x-small;
}
.resistor_inline{
	display:inline-block;
}
/* Block de visualisation du stock*/
#stock_view_resistor, #stock_view_capacitor {
	left:0;
	overflow:auto;
	text-align:left;
	padding-top:0.25em;
	padding-bottom:0.25em;
}
#stock_view_resistor .div_article, #stock_view_capacitor .div_article{
	padding:0; margin:0;
}
#stock_view_resistor .div_button , #stock_view_capacitor .div_button{
	opacity:0;
	display:block;
}
#stock_view_resistor .div_article:hover, #stock_view_capacitor .div_article:hover{
	background-color:white;
}
#stock_view_resistor .div_article:hover .div_button,
#stock_view_capacitor .div_article:hover .div_button {
	opacity:1;
}
#stock_view_resistor .div_article .div_button button
#stock_view_capacitor .div_article .div_button button{
	margin:0px;
	padding:0px;
	display:inline;
	opacity:0.7;
	position:relative;
}
#stock_view_resistor .div_article .div_button button:hover,
#stock_view_capacitor .div_article .div_button button{
	opacity:1;
}
#stock_view_resistor .div_button{
	display:none;
}
#stock_view_resistor:hover .div_button{
	display:block;
}
#taken_stock_view_resistor {
	padding-top:1em;
	padding-bottom:1em;
	width:100%;
	height:10em;
	overflow:auto;
}
.draggable{
	cursor:move;
}
.droppable{
	cursor:cell;
}
.border_round{
	border-radius:1em;
}
.rotate_item_unvertical {
	transform: rotate(90deg);
	-webkit-transform: rotate(90deg);
	-ms-transform: rotate(90deg);
	display:inline-block;
}
.up_big_item{
	position:relative;
	bottom:0.5em;
}
.up_small_item{
	position:relative;
	bottom:0.25em;
}
.down_small_item{
	position:relative;
	bottom:-0.25em;
}
.rotate_item_vertical {
	transform: rotate(-90deg);
	-webkit-transform: rotate(-90deg);
	-ms-transform: rotate(-90deg);
	display:inline-block;
}
.rotate_item_shake {
	transform: rotate(-10deg);
	-webkit-transform: rotate(-10deg);
	-ms-transform: rotate(-10deg);
}
.rotate_item_hurt1 {
	transform: rotate(-45deg);
	-webkit-transform: rotate(-45deg);
	-ms-transform: rotate(-45deg);
}
.rotate_item_hurt2 {
	transform: rotate(-120deg);
	-webkit-transform: rotate(-120deg);
	-ms-transform: rotate(-120deg);
}
.rotate_item_hurt3 {
	transform: rotate(180deg);
	-webkit-transform: rotate(180deg);
	-ms-transform: rotate(180deg);
}
.rotate_item_hurt4 {
	transform: rotate(120deg);
	-webkit-transform: rotate(120deg);
	-ms-transform: rotate(120deg);
}
.rotate_item_hurt5 {
	transform: rotate(45deg);
	-webkit-transform: rotate(45deg);
	-ms-transform: rotate(45deg);
}
/*Element d'aide*/
.hidden_data{
	opacity:0;
}
.blink_data{
	opacity:0.25;
}
.shown_data{
	opacity:0.9;
}
big{
	font-size:2em;
}
.info{
	font-size:small;
	text-align:left;
	margin-left:10%;
}
.info li{
	font-size:small;
	text-align:left;
}

#menu{
	position: fixed;
	right:0em;
	top:0;
	text-align:center;
	}
#menu .active{
	background-color:yellow;
}
#menu li{
	padding:0.5vw;
	margin-top:0.2vw;
	border:1px solid green;
}
nav ul ul {
	display: none;
}
nav ul li > ul:hover {
	display: none;
}
nav ul li:hover > ul {
	display: block;
}
nav ul {
	list-style: none;
	margin:0;
}
nav ul:after {
	content: ""; clear: both; display: block;
}
a{
	font-size:1.2vw;
	padding:0.1vw;
	margin:0.1vw;
	text-decoration:none;
}
#notes {
	display:none;
}
#mini_calc div{
	text-align:left;
}
.radio_redzone{
	border-top:2px dashed red;
}
.radio_orangezone{
	border-top:2px dashed orange;
}
.radio_greenzone{
	border-top:2px dashed green;
}
.deprecated{
	background-color:gray;
}
.todo{
	color:red;
	border:2px dashed red;
/*
	background-color:white;
*/
	font-weight:bold;
	font-size:small;
	position:relative;
	left:-4em;
	top:0.8em;
	transform: rotate(-18deg);
	-webkit-transform: rotate(-18deg);
	-ms-transform: rotate(-18deg);
	max-width:4em;
}
@media screen and (min-width: 1320px) {
	#stock_view_resistor .resistor_view_canvas{
		font-size:small;
	}
	#stock_view_resistor .resistor_view_canvas{
		margin-left:0.5em;
		margin-right:0.5em;
		margin-bottom:5px;
	}
}
@media screen and (max-width: 1320px) {
	#stock_view_resistor .resistor_view_canvas{
		font-size:x-small;
	}
	#stock_view_resistor .div_article .shown_data {
		font-size:0.7em;
	}
	#stock_view_resistor .div_article .blink_data {
		font-size:0.7em;
	}
	#stock_view_resistor .resistor_view_canvas{
		margin-left:0.2em;
		margin-right:0.2em;
		margin-bottom:0.2em;
	}
}
@media screen and (min-width: 1024px) {
	#menu .longtitle{
		display:inline;
	}
	#menu .shorttitle{
		display:none;
	}
}
@media screen and (max-width: 1024px) {
	#stock_view_resistor .div_article .shown_data {
		font-size:0.6em;
	}
	#stock_view_resistor .div_article .blink_data {
		font-size:0.6em;
	}
	#stock_view_resistor .resistor_view_canvas{
		margin-left:0;
		margin-right:0;
		margin-bottom:0;
	}
	#menu .longtitle{
		display:none;
	}
	#menu .shorttitle{
		display:inline;
	}

}
@media screen and (max-width: 480px) {
	#menu:hover{
		right:0;
	}
	#menu {
		right:-5em;
		font-size:small;
	}
}
</style>
</head>
<body>
<nav id="menu">
<ul>
<li id='nav_resistor_decoder' ondragover=
"switchApp('resistor_decoder')" onclick=
"switchApp('resistor_decoder')"><span class=
'longtitle'>Lecture/déchiffrage</span><span class=
'shorttitle'>Déchiffrage</span></li>
<li id='nav_mini_calc' onclick="switchApp('mini_calc')">Mini
calc<span class='longtitle'>ulatrice</span></li>
<li id='nav_calc_combi_resistance' onclick=
"switchApp('calc_combi_resistance')">Combinaisons</li>
<li id='nav_calcul_puissance' onclick=
"switchApp('calcul_puissance')">Puissance</li>
<li id='nav_diviseur_tension' onclick=
"switchApp('diviseur_tension')">Div<span class=
'longtitle'>iseur de</span> <span class=
'shorttitle'>.<br></span>tension</li>
<li id='nav_block_stock_resistor' ondragover=
"switchApp('block_stock_resistor')" onclick=
"switchApp('block_stock_resistor')" title="Resistances">
&mdash;[///]&mdash;<span class='longtitle'><br>
Mes résistances</span></li>
<li id='nav_block_stock_capacitor' ondragover=
"switchApp('block_stock_capacitor')" onclick=
"switchApp('block_stock_capacitor')" title="Condensateurs">
&mdash;| |&mdash;<span class='longtitle'><br>
Mes condensateurs</span></li>
</ul>
</nav>
<section id='corps'></section>
<article class='app' id='resistor_decoder'>
<header>
<h3>Lecture/déchiffrage</h3>
</header>
<section class='cadre'>
<section>
<div class='resistor_desc' ondrop=
"dropText(event,get_resistance)" ondragover=
"allowDrop(event);">
<label for='component_value' class='title'>Valeur
:</label> <span type='text' id='component_value'>?</span>
<button onclick='store_resistance()' id='stock_add_btn'
class='button_disabled' title="Ajouter au stock" disabled
>+</button>
<p></p>
<p><label for='component_desc_'>Desc.:</label>
<span class='view mixed_input' id='component_desc'
onblur='get_resistance();' onkeydown=
'run_get_resistance(event);'>[ <input ondrop=
'event.preventDefault()' id='desc_v0' type='number' size=
"1" min="0" max="9">, <input ondrop=
'event.preventDefault()' id='desc_v1' type='number' size=
"1" min="0" max="9">, <input ondrop=
'event.preventDefault()' id='desc_v2' type='number' size=
"1" min="0" max="9">, <input ondrop=
'event.preventDefault()' id='desc_mult' type='string'
size="3">, <input ondrop='event.preventDefault()' id=
'desc_tol' type='string' size="3">, <input ondrop=
'event.preventDefault()' id='desc_pkg' type='string'
size="4">]</span></p>
</div>
</section>
<section id='resistor_settings'>
<article>
<div class='resistor_mode_list'>
<ul class='underlined'>
<li class='title'>Package</li>
<li id='PACKAGE_RING' name='PACKAGE'>
<div class=''>
<small>&mdash;<span id='resistor_body' class=
'resistor_view cei_color_Beige'>&nbsp;<span id=
'border_view_value0'><span id=
'view_value0'></span></span><span id=
'border_view_value1'><span id=
'view_value1'></span></span><span id=
'border_view_value2'><span id=
'view_value2'></span></span><span id=
'border_view_mult'><span id=
'view_mult'></span></span><span id=
'border_view_tol'><span id=
'view_tol'></span></span><span id=
'border_view_ppm'><span id=
'view_ppm'></span></span></span>&mdash;</small>
</div>
</li>
<li id='PACKAGE_BOBINE' name='PACKAGE'>
<div class='up_small_item'>
o-<span class='power_resistor_view'>&nbsp;R
P&gt;1W&nbsp;</span>-o
</div>
</li>
<li id='PACKAGE_CERAMIC' name='PACKAGE'>
<div class=
'eletrolytic_pkg_view_cylinder ceramic_color_Brown down_small_item'>
&nbsp;...&nbsp;
</div>
<div class=''>
|&nbsp;|
</div>
</li>
<li id='PACKAGE_PLASTIC' name='PACKAGE'>
<div class='up_small_item'>
<small class='plastic_pkg_view cei_color_Blue'
ondragover=
"event.preventDefault();">&mu;....</small>
</div>
</li><!--
electrolytic capacitor
-->
<li id='PACKAGE_ELECTROLYTIC' name='PACKAGE'>
<div class='up_big_item'>
<div class='rotate_item_unvertical'>
<span><span><span class=
'eletrolytic_pkg_view_cylinder cei_color_Black'>
<small><span class=
'eletrolytic_pkg_view_round cei_color_Silver'>&nbsp;&nbsp;&nbsp;</span><strong>===</strong></small></span></span></span>
</div>
</div>
<div class=''>
||
</div>
</li>
</ul>
</div>
<div id='pkg_color' class='resistor_mode_list'>
<ul>
<li class='title'>Couleur</li>
<li id="RESISTOR_CARBON" name='PKG_COLOR'>R 0,5W</li>
<li id="RESISTOR_METAL_BLUE" name='PKG_COLOR'>R
0,4W</li>
<li id="RESISTOR_METAL_GREEN" name='PKG_COLOR'>R
0,4W</li>
<li id="RESISTOR_METAL_RED" name='PKG_COLOR'>R
1W</li>
<li id="CAPACITOR_PINK" name='PKG_COLOR'>C</li>
<li id="CAPACITOR_GREEN" name='PKG_COLOR'>C</li>
</ul>
</div>
<div id='nb_ring' class='resistor_mode_list' title=
"Nombre d'anneaux"></div>
</article>
<article>
<div class='cei_color_block'>
<div class='resistor_prop_title'>
Valeur
</div>
<div id='value0' class='resistor_value_selector'></div>
<div id='value1' class='resistor_value_selector'></div>
<div id='value2' class='resistor_value_selector'></div>
</div>
<div class='cei_color_block'>
<div class='resistor_prop_title'>
Multiple
</div>
<div id='mult' class='resistor_value_selector'></div>
</div>
<div class='cei_color_block'>
<div class='resistor_prop_title'>
Tolérance<br>
<span class='info'>(en %)</span>
</div>
<div id='tol' class='resistor_value_selector'></div>
</div>
<div class='cei_color_block'>
<div class='resistor_prop_title'>
Charge<br>
admissible<br>
<span class='info'>(en W)</span>
</div>
<div id='pow' class='resistor_value_selector'></div>
</div>
<ul class=
'cei_color_list font-small resistor_value_selector' id=
'ppm'>
<li>
<div class='resistor_prop_title'>
Coef.temp.
</div>
</li>
<li class='cei_color_Black' onclick=
'ppm_set(200,"cei_color_Black")'>200ppm</li>
<li class='cei_color_Brown' onclick=
'ppm_set(100,"cei_color_Brown")'>100ppm</li>
<li class='cei_color_Red' onclick=
'ppm_set(50,"cei_color_Red")'>50ppm</li>
<li class='cei_color_Orange' onclick=
'ppm_set(15,"cei_color_Orange")'>15ppm</li>
<li class='cei_color_Yellow' onclick=
'ppm_set(25,"cei_color_Yellow")'>25ppm</li>
</ul>
</article>
</section>
</section>
</article>
<article class='app' id="calc_combi_resistance">
<header>
<h3>Recherche de combinaisons</h3>
</header>
<section class="cadre">
<section class='block_form1'>
<form>
<label for="resistance">Résistance souhaitée <small>(en
Ohm)</small></label><input type="number" value="10500"
name="resistance" id="resistance" onchange=
"document.getElementById('resistance_link').value=this.value;"><br>

<label for="ecart">Tolérance approximative <small>(en
%)</small></label><input type="number" value="2" name=
"ecart" id="ecart" min="0.5" step="0.5" max="25"
onchange="document.getElementById('ecart_link').value=this.value;"><br>

<label for="nbresistances">Nombre maximum de
resistances</label><input type="number" value="4" min="1"
max="8" name="nbresistances" id="nbresistances" onchange=
"document.getElementById('nbresistances_link').value=this.value;"><br>
</form><button onclick="start_calcul_combinaisons();" id=
"button_chercher">Chercher !</button> <button class=
"button_hidden" id=
"button_chercher_loading"></button><br>
</section>
<section class='block_form2'>
<label for="grp_resistance1">Solution 1 :</label>
<input class="formule" type="text" name="grp_resistance1"
id="grp_resistance1" disabled> <span class="valeur" type=
"text" name="grp_resistance_val1" id=
"grp_resistance_val1"></span> <button onclick=
"prendre_grp(1)" id='prendre_grp1_btn' class=
"button_hidden">Mettre de coté</button><br>
<label for="grp_resistance2">Solution 2 :</label>
<input class="formule" type="text" name="grp_resistance2"
id="grp_resistance2" disabled> <span class="valeur" type=
"text" name="grp_resistance_val2" id=
"grp_resistance_val2"></span> <button onclick=
"prendre_grp(2)" id='prendre_grp2_btn' class=
"button_hidden">Mettre de coté</button><br>
<label for="grp_resistance3">Solution 3 :</label>
<input class="formule" type="text" name="grp_resistance3"
id="grp_resistance3" disabled> <span class="valeur" type=
"text" name="grp_resistance_val3" id=
"grp_resistance_val3"></span> <button onclick=
"prendre_grp(3)" id='prendre_grp3_btn' class=
"button_hidden">Mettre de coté</button><br>
</section>
<section class='block_stock' id=
'cadre_taken_stock_view_resistor'>
<label for="taken_stock_view_resistor">Resistances mises de
coté :<br></label>
<section id='taken_stock_view_resistor'></section>
<form>
<input type="string" value="" class="stock" name=
"my_stock_resistor_pris" id="my_stock_resistor_pris"
onclick="makeViewFromFormattedTakenStock();">
</form><br>
</section>
</section>
<p class="info">Légende : ( R1 <strong>+</strong> R2 ) &rarr;
résistances en série; ( R1 <strong>//</strong> R2 ) &rarr;
résistances en parallèle.</p>
</article>
<article class='app' id="calcul_puissance">
<header>
<h3>Vérification de puissance</h3>
</header>
<section class='block_form0 cadre'>
<form>
<label for="resistance_link">Résistance</label><input size=
"8" name="resistance" id="resistance_link"> <label for=
"tension">Tension aux bornes<small>(en
Volt)</small></label> <input size="6" value="9" name=
"tension" id="tension"> <label for="puissance">Puissance à
dissiper<small>(en Watt)</small></label> <input size="6"
value="" name="puissance" id="puissance" disabled>
<button onclick="calcul_puissance();return false;" title=
"Vérifier la puissance">Calculer !</button>
</form><span><small id="indication_puissance"></small></span>
</section>
</article>
<article class='app' id="mini_calc">
<header>
<h3>Mini calculatrice</h3>
</header>
<section class='block_form0'>
<p class="info">Opérateurs : ( R1 <strong>+</strong> R2 )
&rarr; composants en série; ( R1 <strong>//</strong> R2 )
&rarr; composants en parallèle.</p>
<p class="info">Grandeurs : <strong>p</strong>ico(10^-12);
<strong>n</strong>ano(10^-9);
<strong>u</strong>:micro(10^-6);
<strong>m</strong>illi(10^-3); <strong>k</strong>ilo(10^3);
<strong>M</strong>ega(10^-6)</p>
<div>
Résistance &mdash;[///]- <span><input type="text" value=
"" name="calc_in_resistance" id="calc_in_resistance" size=
"20" onchange="mini_calc_resistance()" placeholder=
"r // ( ((a+b)*(a-b)) / c )"></span>=<span id=
"calc_out_resistance"></span> Ohm
</div>
<div>
Capacitance &mdash;| |&mdash; <span><input type="text"
value="" name="calc_in_capacitance" id=
"calc_in_capacitance" size="20" onchange=
"mini_calc_capacitance()" placeholder=
"r // ( ((a+b)*(a-b)) / c )"></span>=<span id=
"calc_out_capacitance"></span> Farad
</div>
</section>
</article>
<article class='app' id="diviseur_tension">
<header>
<h3>Calcul des résistances d'un pont diviseur de tension</h3>
</header>
<section class='block_form0 cadre'>
<form>
<label for="ecart_link">Tolérance approximative <small>(en
%)</small></label><input size="4" id="ecart_link" disabled>
<label for="nbresistances_link">Nb. max. de resistances par
R</label><input size="4" id="nbresistances_link" disabled
><br>
<label for="t_in">Ue <small>(en V)</small></label>
<input type="text" size="4" value="9" name="t_in" id=
"t_in"> <label for="t_out">Us <small>(en V)</small></label>
<input type="text" size="4" value="0.2" name="t_out" id=
"t_out"><br>
<label for="charge_in">Re <small>(en Ohm)</small></label>
<input type="text" size="4" value="0" name="charge_in" id=
"charge_in"> <label for="charge_out">Rs <small>(en
Ohm)</small></label> <input type="text" size="4" value=
"20k" name="charge_out" id="charge_out"><br>
<small><label for="influence_percent">Faible influence de
Rs</label> <span class='radio_redzone'><input type="radio"
value="1" name="influence_percent" title="1%"></span>
<input type="radio" value="2" name="influence_percent"
title="2%"></small> <input type="radio" value="3" name=
"influence_percent" title="3%"> <input type="radio" value=
"4" name="influence_percent" title="4%"> <span class=
'radio_orangezone'><input type="radio" value="5" name=
"influence_percent" title="5%"></span> <input type="radio"
value="10" name="influence_percent" title="10%">
<input type="radio" value="15" name="influence_percent"
title="15%"> <input type="radio" value="20" name=
"influence_percent" title="20%"> <span class=
'radio_greenzone'><input type="radio" value="25" name=
"influence_percent" title="25%"></span> <input type="radio"
value="30" name="influence_percent" title="30%" checked=
"checked"> <input type="radio" value="35" name=
"influence_percent" title="35%"> <input type="radio" value=
"40" name="influence_percent" title="40%"> <input type=
"radio" value="45" name="influence_percent" title="45%">
<input type="radio" value="50" name="influence_percent"
title="50%"> <span class='radio_orangezone'><input type=
"radio" value="60" name="influence_percent" title=
"60%"></span> <input type="radio" value="70" name=
"influence_percent" title="70%"> <span class=
'radio_redzone'><input type="radio" value="90" name=
"influence_percent" title="90%"></span> <input type="radio"
value="100" name="influence_percent" title="100%">
<label for="influence_percent">Faible
consommation</label><br>
</form><button onclick="cherche_div_tension();" id=
'btn_cherche_div_tension'>Chercher!</button><button class=
"button_hidden" id=
"btn_cherche_div_tension_loading"></button><button onclick=
"cherche_div_tension_stock();" id=
'btn_cherche_div_tension_stock'>Chercher dans le
stock!</button> <button class="button_hidden" id=
"btn_cherche_div_tension_stock_loading"></button>
</section>
<section>
<p id="formule_div_tension">Us=Ue*( R'2 / (R'1+R'2) ) avec
R'1=R1+Re et R'2=R2//Rs</p>
<p id="solution_div_tension"></p><br>
<canvas id="monCanvas" width="200" height="150" style=
"border:1px solid #c3c3c3;">
Votre navigateur ne supporte pas l'élément &lt;canvas&gt;.
</canvas>
</section>
</article>
<article class="app" id='block_stock_resistor'>
<section class="droppable" id='stock_view_resistor' ondrop=
"dropOnStock(event)" ondragover="allowDrop(event)"></section>
<section class='block_stock'>
<div class='title'>
<label for="my_stock_resistor">Stock de resistances
<small>(en Ohm, séparées par des
espaces)</small>:<br></label>
</div>
<form>
<textarea ondrop=
"add_to_stock(event.dataTransfer.getData('text'));"
ondragover="allowDrop(event);" id="my_stock_resistor"
title="Aide : les notations k=*1000 M=*1000000 sont authorisées"
onmouseout="updateStock(); is_valid_stock(this);" onblur=
"updateStock(); is_valid_stock(this);" rows="4" cols=
"50"></textarea>
</form>
</section>
</article>
<article class="app" id='block_stock_capacitor'>
<section class="droppable" id='stock_view_capacitor' ondrop=
"dropOnStock(event)" ondragover="allowDrop(event)"></section>
<section class='block_stock'>
<div class='title'>
<label for="my_stock_capacitor">Stock de condensateurs
<small>(en Farad, séparées par des
espaces)</small>:<br></label>
</div>
<form>
<textarea ondrop=
"add_to_stock(event.dataTransfer.getData('text'));"
ondragover="allowDrop(event);" id="my_stock_capacitor"
title=
"Aide : les notations u=e-6 n=e-9 p=e-12  sont authorisées"
onmouseout="updateStock(); is_valid_stock(this);" onblur=
"updateStock(); is_valid_stock(this);" rows="4" cols=
"50"></textarea>
</form>
</section>
</article>
<footer>
<div>
<h3>DIY. Die what ?</h3>
<p>Ceci est une série d'outils visant à faciliter de la
récup' de composants électroniques.</p>
<p>2015 Copyleft :<br>
Sébastien Gillot</p>
<p>Tests navigateurs :<br>
Chromium : Ok;<br>
Mozilla : Ok;<br>
Webkit:à vérifier.</p>
<ul>
<li>
<div class='todo'>
<h3>À faire</h3>
</div>
</li>
<li>Permettre de charger un fichier de conf. cf
test_buttons.js</li>
<li>Compléter les tests unitaires</li>
<li>Rendre plus agréable l'ergonomie</li>
</ul>
</div>
<div>
<ul>
<li>
<h3>Liens :::::::::::::::::::::::::</h3>
</li>
<li>
<a href=
"http://www.sonelec-musique.com/electronique_theorie_resistance.html">
Infos sur les résistances</a>
</li>
<li>
<a href="https://fr.wikipedia.org/wiki/CEI_60757">Infos
sur les codes valeurs</a>
</li>
<li>
<a onclick=
"if (confirm('Download lastest version?')){window.location='https://github.com/luffah/diy-heaven/archive/master.zip';};">
Download lastest version</a>
</li>
<li>
<a href=
"https://github.com/luffah/diy-heaven/issues">Report a
bug !</a><br>
</li>
</ul>
</div>
</footer><!--Javascript-->
<!-- Fonctions de calcul --><!--Effets graphique et animations-->
<!---->
<!--Déchiffrage d'une résistance-->
<!--Pour la gestion du stock-->
<!-- Drag and drop et deplacement des vues de résistance-->
<div>
<script>
function regexp_class(class_a){
	return new RegExp('(^| )'+class_a+'( |$)','');
}
function htElem(elem_id){
	return document.getElementById(elem_id);
}
function htRemoveClass(ht_elem,class_a){
	ht_elem.className=ht_elem.className.replace(regexp_class(class_a)," ");
}
function htAddClass(ht_elem,class_a){
	ht_elem.className=ht_elem.className+' '+class_a;
}
function htGoTrough(el,obj,func){
	for (var k in obj){
		if (k=='parent'){
			func(el.parentNode,obj[k]);
		}  else if (k=='this'){
			func(el,obj[k]);
		} else {
			func(el.childNodes[k],obj[k]);
		}
	}
}
function addClass(elem_id,class_a){
	var el=htElem(elem_id);
	if (typeof class_a == 'object'){
		htGoTrough(el,class_a,htAddClass);
	} else {
		htAddClass(el,class_a);
	}
}
function removeClass(elem_id,class_a){
	var el=htElem(elem_id);
	if (typeof class_a == 'object'){
		htGoTrough(el,class_a,htRemoveClass);
	} else {
		htRemoveClass(el,class_a);
	}
}
function htSetClassOnEvents(elem,elem_id,class_a){
	if (typeof class_a == 'object'){
		for (var k in class_a){
			elem.setAttribute(k,"setClass('"+elem_id+"','"+class_a[k]+"')");
		}
	}
}
function translateContents(pre_id,h){
	for (var k in h){
		htElem(pre_id+k).innerHTML=h[k];
	}
}
function htSetHover(elem,elem_id,class_a){
	elem.setAttribute('onmouseover',"addClass('"+elem_id+"',"+class_a+")");		
	elem.setAttribute('onmouseout',"removeClass('"+elem_id+"',"+class_a+")");		
}
function setClass(elem_id,class_a){
	htElem(elem_id).className=class_a;
}
function setInputValue(elem_id,val){
	htElem(elem_id).value=val;
}
function setDisplay(elem_id,dis_a){
	htElem(elem_id).style.display=dis_a;
}
function setVisible(elem_id,boolean){
	htElem(elem_id).style.visibility=boolean?'visible':'hidden';
}
function setInnerHTML(elem_id,txt){
	htElem(elem_id).innerHTML=txt;
}
function getClass(elem_id){
	return htElem(elem_id).className;
}
function switchClass(array_id_a,class_a,array_id_b) {
	var idx;
	for (idx=0;idx<array_id_a.length;idx++) {
		addClass(array_id_a[idx],class_a);
	}
	for (idx=0;idx<array_id_b.length;idx++) {
		removeClass(array_id_b[idx],class_a);
	}
}
function getCheckedElementByName(doc,elem_name) {
	var radios=doc.getElementsByName(elem_name);
	var res;
	for (var i = 0, length = radios.length; i < length; i++) {
		if (radios[i].checked) {
			res=radios[i];
			break;
		}
	}
	return res;
}
function secureText(data) {
	return data.replace("<",'&lt;').replace(">",'&gt;').replace("&mu;","u").replace("µ","u");
}
function makeHtmlTag(tagname,txt,list_attr){
	var res="<"+tagname;
	for (k in list_attr){
		if (list_attr[k]!=null){
			res=res+" "+k+'="'+list_attr[k]+'"'
		}
	}
	res=res+">"+txt+"</"+tagname+">";
	return res;
}
function htmlBtn(txt,list_attr){
	return makeHtmlTag("button",txt,list_attr);
}
function htmlArticle(txt,list_attr){
	return makeHtmlTag("article",txt,list_attr);
}
function htmlFigure(txt,caption,list_attr){
	return makeHtmlTag("figure",txt + makeHtmlTag('figcaption',caption,{}) ,list_attr);
}
function htmlDiv(tab_txt,list_attr,tab_order){
	var txt;
	if (typeof tab_txt == 'string') {
		txt=tab_txt;
	} else if (tab_order != null) {
		txt="";
		for (var i=0; i<tab_order.length; i++){
			txt=txt+tab_txt[tab_order[i]];
		}
	} else {
		txt=tab_txt.join("");
	}
	return makeHtmlTag("div",txt,list_attr);
}
function htmlSmall(txt){
	return makeHtmlTag("small",txt,{});
}
function htmlLarge(txt){
	return makeHtmlTag("large",txt,{});
}
function htmlBig(txt){
	return makeHtmlTag("big",txt,{});
}
function htmlStrong(txt){
	return makeHtmlTag("big",txt,{});
}
function htmlSpan(txt,list_attr){
	return makeHtmlTag("span",txt,list_attr);
}
function htmlMatrix(tab_fill,tag,hash_elem_func){
	var elems="";
	for (var i = 0; i < tab_fill.length; i++) {
		elems=elems+'<'+tag+'>';
		for (var k = 0; k < tab_fill[i].length; k++) {
			if (hash_elem_func!=null){
				if ( tab_fill[i][k] in hash_elem_func ){
					func=hash_elem_func[tab_fill[i][k]];
				} else if ('default' in hash_elem_func ){
					func=hash_elem_func['default'];
				} else {
					func=tab_fill[i][k];
				}
			} else { func=tab_fill[i][k]; }
			elems=elems+((typeof func=='function')?func(tab_fill[i][k]):func);
		}
		elems=elems+'</'+tag+'>';
	}
	return elems;
}
</script>
</script>
<script>
//
function reverseDict(dict) {
	var res={
	};
	for (var k in dict) {
		res[dict[k]]=k;
	}
	return res;
}
function hashToString(h){
	var h_txt='{';
	for (var k in h){
		h_txt=h_txt+k+':'+h[k].toString()+',';
	}
	return h_txt.replace(/,$/,'')+'}';
}
</script>
</script>
<script>
function equal(a,b){return a==b;}
function greater_than(a,b){return a>b;}
var unit_tests_msg={true:[],false:[]};
var unit_test_idx=0;

function testFunction(func,par,eres,testvalid,name,error){
	var res=null;
	if (par.length===0){ res=func(); }
	else if (par.length==1){ res=func(par[0]); }
	else if (par.length==2){ res=func(par[0],par[1]);  }
	else if (par.length==3){ res=func(par[0],par[1],par[2]); }
	else if (par.length==4){ res=func(par[0],par[1],par[2],par[3]); }
	else if (par.length==5){ res=func(par[0],par[1],par[2],par[3],par[4]); }
	else if (par.length==6){ res=func(par[0],par[1],par[2],par[3],par[4],par[5]); }
	else if (par.length==7){ res=func(par[0],par[1],par[2],par[3],par[4],par[5],par[6]);}
	else if (par.length==8){ res=func(par[0],par[1],par[2],par[3],par[4],par[5],par[6],par[7]); }
	else if (par.length==9){ res=func(par[0],par[1],par[2],par[3],par[4],par[5],par[6],par[7],par[8]); }
	unit_test_idx++;
	var t=testvalid(res,eres)?true:false;
	var par_txt=par.map(function (a){return a.toString()}).join("' ,\n\t'");
	var msg="Assertion #"+ unit_test_idx + ((name!=null && name!="")?(" ["+name + "]"):"") + " : "  + 
		func.name+"(\n\t'"+par_txt+"')\n == \n\t'"+eres.toString()+
		"'\n; found "+res;
	unit_tests_msg[t].push();
	if ( (error!=null) && !t){
		console.log(msg+ "\nthrows '"+error+"'");
		throw error;
	}
}
function areUnitTestsOk(){
	if (unit_tests_msg[false].length>0){
		for (var k in unit_tests_msg[false]){
			console.log(unit_tests_msg[false][k]);
		}
		return false;
	}
	return true;
}

var LIB_UNITTEST_LOADED=false;
</script>
</script>
<script>
function parseUnit(a) {
	var res;
	var pos_mult=a.search(/(k|M|m|n|u|p)/i);
	if (pos_mult>-1) {
		res=a.charAt(pos_mult);
		res=parseFloat(a.replace(/(k|M|m|n|u|p)( |$)/i,'').replace(/(k|M|m|n|u|p)/i,'.'))*
		(res=='M'?1000000:
		(res=='k'?1000:
		(res=='m'?parseFloat(Math.pow(10,-3)):
		(res=='u'?parseFloat(Math.pow(10,-6)):
		(res=='n'?parseFloat(Math.pow(10,-9)):
		(res=='p'?parseFloat(Math.pow(10,-12)):1))))));
	} else {
		res=parseFloat(a);
	}
	return res;
}
function roundRelative(a,p) {
	var res=a+"";
	var e_num = (Math.round(Math.log(a)/Math.log(10)))-p;//get exp number
	return Math.round(a/Math.pow(10,e_num))/Math.pow(10,-e_num);
}
function formatUnit(a,details) {
	var res=a+"";
	var p=4;//precision
	if (a>-1) {
		if (a>=1000000) {
			res=Math.round(a*Math.pow(10,p))/Math.pow(10,p+6)+'M';
		} else if (a>=1000) {
			res=Math.round(a*Math.pow(10,p))/Math.pow(10,p+3)+'k';
		} else if (a>=1) {
			res=Math.round(a*Math.pow(10,p))/Math.pow(10,p);
		} else if (a>=Math.pow(10,-3)) {
			res=Math.round(a*Math.pow(10,3+p))/Math.pow(10,p)+'m';
		} else if (a>=Math.pow(10,-6)) {
			res=Math.round(a*Math.pow(10,6+p))/Math.pow(10,p)+'&mu;';
		} else if (a>=Math.pow(10,-9)) {
			p=6;
			res=(details? Math.round(a*Math.pow(10,6+p))/Math.pow(10,p)+'&mu;' +
			' ou ' : "")+ Math.round(a*Math.pow(10,9+p))/Math.pow(10,p)+'n';	   
		} else {
			p=8;
			res=Math.round(a*Math.pow(10,6+p))/Math.pow(10,p)+'&mu;';
			res=res + ' ou ' + Math.round(a*Math.pow(10,9+p))/Math.pow(10,p)+'n';	   
			res=(details?Math.round(a*Math.pow(10,6+p))/Math.pow(10,p)+'&mu;' +
			 ' ou' + Math.round(a*Math.pow(10,9+p))/Math.pow(10,p)+ 'n' +
			 ' ou ':"")+ Math.round(a*Math.pow(10,12+p))/Math.pow(10,p)+'p' ;
				   
		}
	}
	return res;
}
if(LIB_UNITTEST_LOADED){
	testFunction(roundRelative,[0.00123456789,3],0.001235,equal,"",Error("lib_unit"));
	testFunction(roundRelative,[0.0123456789,3],0.01235,equal,"",Error("lib_unit"));
	testFunction(roundRelative,[1.23456789,3],1.235,equal,"",Error("lib_unit"));
	testFunction(parseUnit,['10nf'],'1e-8',equal,"",Error("lib_unit"));
	testFunction(formatUnit,['1e-8'],'10n',equal,"",Error("lib_unit"));
	testFunction(formatUnit,['1e-8',true],'0.01&mu; ou 10n',equal,"",Error("lib_unit"));
}

</script>
</script>
<script>
function getValResistancesEnSerie(a,b) {
	return parseFloat(parseFloat(a)+parseFloat(b));
}
function getValResistancesEnParallel(a,b) {
	var v_a=parseFloat(a);
	var v_b=parseFloat(b);
	if (v_a==v_b) {
		res=v_a/2;
	} else {
		res=((v_a*v_b)/(v_a+v_b));
	}
	return parseFloat(res);
}
function getValCondensateursEnParallel(a,b) {
	return getValResistancesEnSerie(a,b);
}
function getValCondensateursEnSerie(a,b) {
	return getValResistancesEnParallel(a,b);
}

var combine_resistance={
	'+':getValResistancesEnSerie,
	'//':getValResistancesEnParallel,
	'-':function (a,b){return a-b;},
	'*':function (a,b){return a*b;},
	'/':function (a,b){return a/b;}
}
var combine_capacitance={
	'+':getValCondensateursEnSerie,
	'//':getValCondensateursEnParallel,
	'-':function (a,b){return a-b;},
	'*':function (a,b){return a*b;},
	'/':function (a,b){return a/b;}
}

function parseAndCompute(formule,funcset) {
	/* // -> funcpar;  + -> funcadd */
	//enleve les espace inutiles
	
	var res=formule.replace('µ','u').replace(/\([\s]*([0-9.]+[Mmknup]?[0-9]*(e[-]?[1-9][0-9]?)?[Mmknup]?)[\s]*\)/,function(x,y) {return y;});
	if (! (/(\/\/|\+|-|\*|\/)/.test(res)) ) {
		//si pas d'operateur binaire
		res=parseUnit(res);
	} else { // sinon
		while ((/(^|\()[\s]*([0-9.]+[Mmknup]?[0-9]*(e[-]?[1-9][0-9]?)?[Mmknup]?)[\s]*(\/\/|\+|-|\*|\/)[\s]*([0-9.]+[Mmknup]?[0-9]*(e[-]?[1-9][0-9]?)?[Mmknup]?)[\s]*(\)|$)/.test(res))) {
		res=res.replace(/(^|\()[\s]*([0-9.]+[Mmknup]?[0-9]*(e[-]?[1-9][0-9]?)?[Mmknup]?)[\s]*(\/\/|\+|-|\*|\/)[\s]*([0-9.]+[Mmknup]?[0-9]*(e[-]?[1-9][0-9]?)?[Mmknup]?)[\s]*(\)|$)/g,
			function(a,b,c,d,e,f,g,h,i,j) {
				return funcset[e](parseUnit(c),parseUnit(f));
			}
		);
		}
	}
	return res;
}


if(LIB_UNITTEST_LOADED){
	testFunction(getValCondensateursEnParallel,[0.01,0.01],0.02,equal,"",Error("lib_physics"));
	testFunction(getValCondensateursEnSerie,[0.01,0.01],0.005,equal,"",Error("lib_physics"));
	testFunction(getValResistancesEnParallel,[100,100],50,equal,"",Error("lib_physics"));
	testFunction(getValResistancesEnSerie,[100,100],200,equal,"",Error("lib_physics"));
}

</script>
</script>
<script>
var anim={
};
var last_shown='';
var current_interval=0;
function shake(elem_id) {
	try {
	if (!(elem_id in anim)) {
		var elem=document.getElementById(elem_id);
		anim[elem_id]=elem.className;
		setTimeout(function() {
			elem.className=anim[elem_id]+" rotate_item_shake";
		},0);
		setTimeout(function() {
			elem.className=anim[elem_id];
		},100);
		setTimeout(function() {
			elem.className=anim[elem_id]+" rotate_item_shake";
		},200);
		setTimeout(function() {
			elem.className=anim[elem_id];
			delete anim[elem_id];
		},300);
	}
	} catch (e){
		throw(e+" -> elem id="+elem_id);
	}
}
function hurt(elem_id) {
	if (!(elem_id in anim)) {
		var elem=document.getElementById(elem_id);
		anim[elem_id]=elem.className;
		setTimeout(function() {
			elem.className=anim[elem_id]+" rotate_item_hurt1";
		},0);
		setTimeout(function() {
			elem.className=anim[elem_id]+" rotate_item_hurt2";;
		},100);
		setTimeout(function() {
			elem.className=anim[elem_id]+" rotate_item_hurt3";
		},200);
		setTimeout(function() {
			elem.className=anim[elem_id]+" rotate_item_hurt4";
		},300);
		setTimeout(function() {
			elem.className=anim[elem_id]+" rotate_item_hurt5";
		},400);
		setTimeout(function() {
			elem.className=anim[elem_id];
			delete anim[elem_id];
		},500);
	}
}
function blink(elem_id,time1,class1,time2,class2,timeinterval) {
	if(current_interval>0) {
		unblink();
	}
	var elem=document.getElementById(elem_id);
	var orig_class=elem.className;
	current_interval=setInterval(function () {
		setTimeout(function() {
			elem.className=orig_class+((class1.length>0)?("( "+class1):"");
		},time1);
		setTimeout(function() {
			elem.className=orig_class+((class2.length>0)?("( "+class2):"");
		},time2);
	},timeinterval);
}
function unblink() {
	clearInterval(current_interval);
	current_interval=0;
}
</script>
</script>
<script>
var PKG_ID_TO_CHAR={
	'PACKAGE_RING':'r',
	'PACKAGE_BOBINE':'b',
	'PACKAGE_CMS':'s',
	'PACKAGE_CERAMIC':'c',
	'PACKAGE_ELECTROLYTIC':'e',
	'PACKAGE_PLASTIC':'p'
};
var PKG_CHAR_TO_ID=reverseDict(PKG_ID_TO_CHAR);
//mode values
var PKG_ID_TO_MODE={
	'PACKAGE_RING':10,//>=
	'PACKAGE_BOBINE':1,
	'PACKAGE_CMS':2,
	'PACKAGE_CERAMIC':3,
	'PACKAGE_ELECTROLYTIC':4,
	'PACKAGE_PLASTIC':5
};
var PKG_CHAR_TO_ID=reverseDict(PKG_ID_TO_CHAR);

var PKG_ID_TO_TYPE_DEF={
	'PACKAGE_RING':'RESISTOR',
	'PACKAGE_BOBINE':'RESISTOR',
	'PACKAGE_CMS':'RESISTOR',
	'PACKAGE_CERAMIC':'CAPACITOR',
	'PACKAGE_ELECTROLYTIC':'CAPACITOR',
	'PACKAGE_PLASTIC':'CAPACITOR'
};
// body colors for RING resistor      
var PKG_COLOR_ID_TO_CHAR={
	'RESISTOR_CARBON':'C',
	'RESISTOR_METAL_BLUE':'B',
	'RESISTOR_METAL_GREEN':'V',
	'RESISTOR_METAL_RED':'R',
	'CAPACITOR_PINK':'P',
	'CAPACITOR_GREEN':'G'
};
var PKG_COLOR_CHAR_TO_ID=reverseDict(PKG_COLOR_ID_TO_CHAR);
// RESISTOR with rings mode=number of rings
//  norme CEI 60757 pour les codes valeurs
var color_tab_val={"":"cei_color_None",
	0:"cei_color_Black",
	1:"cei_color_Brown",
	4:"cei_color_Yellow",
	7:"cei_color_Violet",
	2:"cei_color_Red",
	5:"cei_color_Green",
	8:"cei_color_Gray",
	3:"cei_color_Orange",
	6:"cei_color_Blue",
	9:"cei_color_White"
};
var color_tab_mult={"":"cei_color_None",
	0.1:"cei_color_Gold",
	0.01:"cei_color_Silver",
	1:"cei_color_Black",
	10:"cei_color_Brown",
	100:"cei_color_Red",
	1000:"cei_color_Orange",
	10000:"cei_color_Yellow",
	100000:"cei_color_Green",
	1000000:"cei_color_Blue",
	10000000:"cei_color_Violet"
};
var color_tab_tolerance={"":"cei_color_None",
	0.20:"cei_color_Transparent",
	0.10:"cei_color_Silver",
	0.05:"cei_color_Gold",
	0.01:"cei_color_Brown",
	0.02:"cei_color_Red",
	0.005:"cei_color_Green",
	0.0025:"cei_color_Blue",
	0.001:"cei_color_Violet"
};
var color_tab_corps={"":"cei_color_None",
	'RESISTOR_CARBON':"cei_color_Beige",
	'RESISTOR_METAL_BLUE':"cei_color_Cyan",
	'RESISTOR_METAL_GREEN':"cei_color_Green",
	'RESISTOR_METAL_RED':"cei_color_Red",
	'CAPACITOR_PINK':"cei_color_Pink",
	'CAPACITOR_GREEN':"cei_color_CapGreen"
};
var PKG_ID_TO_CONTENTS_MULT={
	'PACKAGE_RING':{
	0.1:'0.1',
	0.01:'0.01',
	1:'1',
	10:'10',
	100:'100',
	1000:"1k",
	10000:"10k",
	100000:"100k",
	1000000:"1M",
	10000000:"10M"
	},
	'PACKAGE_CERAMIC':{
	0.1:-2,
	0.01:-1,
	1:0,
	10:1,
	100:2,
	1000:3,
	10000:4,
	100000:5,
	1000000:6,
	10000000:7
	},
	'PACKAGE_ELECTROLYTIC':{
	0.1:'0.1p',
	0.01:'.01p',
	1:'1p',
	10:'10p',
	100:'100p',
	1000:'1n',
	10000:'10n',
	100000:'100n',
	1000000:'1u',
	10000000:'10u'
	},
}
PKG_ID_TO_CONTENTS_MULT['PACKAGE_BOBINE']=PKG_ID_TO_CONTENTS_MULT['PACKAGE_RING'];
PKG_ID_TO_CONTENTS_MULT['PACKAGE_CMS']=PKG_ID_TO_CONTENTS_MULT['PACKAGE_RING'];
PKG_ID_TO_CONTENTS_MULT['PACKAGE_PLASTIC']=PKG_ID_TO_CONTENTS_MULT['PACKAGE_ELECTROLYTIC'];
</script>
</script>
<script>

var ComponentDesc= function(){
	this.value=['','',''];
	this.mult='';
	this.tolerance='';
	this.pow='';
	this.mode='';
	this.type='';
	this.corps='';
	this.package='';
	this.setValue=function (n,v){this.value[n]=v;}
	this.setMult=function (v){this.mult=v+"";}
	this.setTolerance=function (v){this.tolerance=v;}
	this.setPower=function (v){this.pow=v;}
	this.setMode=function (v){this.mode=v;}
	this.setType=function (v){this.type=v;}
	this.setCorps=function (v){this.corps=v;}
	this.setPackage=function (v){this.package=v;}
	this.getRef=function () {
		return secureText(formatUnit(this.getValue())+'['+this.getDesc()+']');
	}
	this.getDesc= function(){
		return "" +
		this.value[0] + "," +
		this.value[1] + "," +
		this.value[2] + "," +
		this.mult.replace(/000000$/,'M').replace(/000$/,'k') + "," +
		this.tolerance + "," +
		((this.pow!='')?this.pow:this.corps);
	}
	this.autosetMode=function (){
		this.mode=get_standard_mode(this.getDesc());
	}
	this.isComplete= function() {
		var nb=PKG_ID_TO_MODE['PACKAGE_RING'];
		return ( (this.value[0] != '') && 
			(this.value[1] != '' || (this.mode<nb+1)) &&
			(this.value[2] != '' || (this.mode<nb+2)) &&
			(this.mult != '' ) &&
			(this.tolerance != '' ) &&
			(this.pow != '' || this.mode!=PKG_ID_TO_MODE['PACKAGE_BOBINE'])
		);
	}
	this.getValue= function() {  
		return compute_value(this.value,this.mult,this.type);
	}
	this.getMeasureAndUnit= function() {
		return this.type=='CAPACITOR'?['C','Farad']:['R','Ohm'];
	}
	this.fromRef= function(desc){
		var tab_desc=get_tab_desc_in_desc(desc);
		
		this.value[0]=tab_desc[0];
		this.value[1]=tab_desc[1];
		this.value[2]=tab_desc[2];
		this.mult=tab_desc[3];
		this.tolerance=tab_desc[4];
		this.type=tab_desc[6];
		if (/^[0-9]+w$/i.test(tab_desc[5])){
			this.pow=tab_desc[5];
		} else if (/^[a-z]+$/i.test(tab_desc[5])) {
			this.corps=tab_desc[5];
		}
	}
}

function compute_value(value,mult,component_type) {
	var val="";
	if (value[0] + "" != "") {
		val=parseInt(value[0]+"");
		if (value[1] + "" !='' ) {
			val=(val*10)+parseInt(value[1]+"");
		}
		if (value[2] + "" != "" ) {
			val=(val*10)+parseInt(value[2]+"");
		}
		if (mult.length>0) {
			val=val*parseFloat(mult+"")*(
			component_type=='CAPACITOR'?Math.pow(10,-12):1);
		}
		
	}
	return val;
}

function get_value_from_tab_desc(tab_desc) {
	//[v0,v1,v2,mult,tolerance,power/color,type=RESISTOR/CAPACITOR];
	return compute_value(
		[tab_desc[0],tab_desc[1],tab_desc[2]],
		tab_desc[3],
		tab_desc[6]);
}
function get_cei_color_tab(desc) {
	var color_tab=['cei_color_None',
	'cei_color_None',
	'cei_color_None',
	'cei_color_None',
	'cei_color_None',
	'cei_color_None'];
	var tab_desc=get_tab_desc_in_desc(desc);
	color_tab[0]=color_tab_val[tab_desc[0]];
	color_tab[1]=color_tab_val[tab_desc[1]];
	color_tab[2]=color_tab_val[tab_desc[2]];
	color_tab[3]=color_tab_mult[tab_desc[3]];
	color_tab[4]=color_tab_tolerance[tab_desc[4]];
	color_tab[5]=color_tab_corps[PKG_COLOR_CHAR_TO_ID[tab_desc[5]]];
	return color_tab;
}
function get_tab_desc_in_desc(desc) {
	//tab_desc format=
	//[val1,val2,val3,mult,tolerance,power/color,type=RESISTOR/CAPACITOR];
	var value_desc=splitValueNDesc(desc);
	var v_val=value_desc[0];
	var v_desc=value_desc[1];
	var tmp_tab;
	var tab_desc=['1','','','1','0.01','C',
								is_capacitor_value(v_val)?'CAPACITOR':
								(is_resistor_value(v_val)?'RESISTOR':'')];

	if (is_desc(v_desc)) {
		tmp_tab=v_desc.split(',');
		for (var i=0; i<6;i++) {
			//default if not defined
			if (tmp_tab[i]!="") {
				tab_desc[i]=tmp_tab[i];
			}
		}
		if (tab_desc[3].length>1) {
			tab_desc[3]=tab_desc[3].replace('k','000').replace('M','000000');
		}
	} else if (is_value(v_val)){
		v_val=parseUnit(v_val);
		if (tab_desc[6]=='CAPACITOR'){
			v_val=v_val*Math.pow(10,12);
		}
		if (v_val<1) {
			v_val=""+v_val*100;
			tab_desc[0]=v_val[1];
			tab_desc[1]=(v_val[2]+"" != "" )?v_val[2]:0;
			tab_desc[2]='';
			tab_desc[3]=0.01;
		} else if (v_val<10){
			v_val=""+v_val*10;
			tab_desc[0]=v_val[1];
			tab_desc[1]=(v_val[2]+"" != "" )?v_val[2]:0;
			tab_desc[2]='';
			tab_desc[3]=0.1;
		} else {
			var e_num = (Math.round(Math.log(v_val/100)/Math.log(10)));//get exp number
			v_val=""+v_val;
			tab_desc[0]=v_val[1];
			tab_desc[1]=v_val[2];
			tab_desc[2]=v_val[3];
			tab_desc[3]=Math.pow(10,e_num);
		}
	}
	return tab_desc;
}
function get_standard_mode(tab_desc) {
	var mode;
	if (/[wW]/.test(tab_desc[5])){
		mode=PKG_ID_TO_MODE['PACKAGE_BOBINE'];
	} else {
		mode=PKG_ID_TO_MODE['PACKAGE_RING'];
		mode=mode+(tab_desc[1]!=''?1:0)+(tab_desc[2]!=''?1:0);
	}
	return mode;
}

function splitValueNDesc(desc){
	var pos1=desc.indexOf('[');
	var pos2=desc.indexOf(']',pos1);
	return [ (pos1 > -1)?desc.substring(0,pos1):'',
			 ((pos1 > -1) &&(pos2 > -1))?desc.substring(pos1+1,pos2):desc ];
}
function is_bobine_resistor(data) {
	return (/^[0-9.]+([kmM][0-9]*)?\[[0-9],[0-9]*,[0-9]*,[01.]+[kmM]?,[a-z0-9.]*,[0-9]+[wW]\]$/i).test(data);
}
function is_conform(data) {
	return (/^[0-9].*\[[0-9],[0-9]?,[0-9]?,[01.]+[kmM]?,[0-9.]*,[a-zA-Z0-9.]*\]$/).test(data);
}
function is_desc(data) {
	return (/^[0-9]?,[0-9]?,[0-9]?,[01.]*[kmM]?,[0-9.]*,[a-zA-Z0-9.]*$/).test(data);
}
function is_value(data) {
	return (/^[0-9]*[kMmnup][0-9]*$/).test(data);
}
function is_ring(data) {
	return (/^[^[]*\[[0-9],[0-9]*,[0-9]*,[01.]+[kmM]?,[0-9.]*,[A-Z]\]$/).test(data);
}
function is_ceramic(data) {
	return (/^[^[]*\[[0-9],[0-9]*,[0-9]*,[01.]+[kmM]?,[0-9.]*,c\]$/).test(data);
}
function is_electrolytic(data) {
	return (/^[^[]*\[[0-9],[0-9]*,[0-9]*,[01.]+[kmM]?,[0-9.]*,e\]$/).test(data);
}
function is_plastic(data) {
	return (/^[^[]*\[[0-9],[0-9]*,[0-9]*,[01.]+[kmM]?,[0-9.]*,p\]$/).test(data);
}
function is_resistor_value(data) {
	return (/^[0-9.]+[kM]?.*$/i).test(data);
}
function is_capacitor_value(data) {
	return (/^[0-9.]+[unp][fF]?.*$/).test(data);
}
function is_resistor(data) {
	return (/^[0-9.]+([kM][0-9]*)?\[.*\]$/).test(data);
}
function is_capacitor(data) {
	return (/^[0-9.]+[unp][fF]?([0-9]*)?\[.*\]$/).test(data);
}
function is_inductance(data) {
	return (/^[0-9.]+[m]?[hH]?([0-9]*)?\[.*\]$/).test(data);
}

function get3DigitNotation(tab_desc){
	var e_num = (Math.round(Math.log(tab_desc[3])/Math.log(10)));//get exp number
	var round_val2=0;//for case [1,0,9,1k,0.01,] we round the value -> 114
	var res=""+tab_desc[0];
	if (tab_desc[1] + "" != ""){
		if (tab_desc[2] + "" != ""){
			 round_val2=Math.round(parseFloat(tab_desc[2])/10);
			 e_num=e_num+1;
		}
		res=res+(parseInt(tab_desc[1])+round_val2);
	} else {
		res=res+'0';
		e_num=e_num-1;
	}
	
	return res + e_num;
}
function correctValueFromDesc(desc){
		var cmpnt=new ComponentDesc();
		cmpnt.fromRef(desc);
		return cmpnt.getRef();
	
}

if(LIB_UNITTEST_LOADED){
	testFunction(is_conform,['21[2,1,,1k,0.01,C]'],true,equal,"",Error('lib_component_desc'));
}
</script>
</script>
<script>
function switchApp(elem_id) {
	if (last_shown!=elem_id) {
		if (last_shown!='') {
			setDisplay(last_shown,'none');
			removeClass('nav_'+last_shown,'active');
		}
		setDisplay(elem_id,'inline-block');
		addClass('nav_'+elem_id,'active');
		last_shown=elem_id;
	}
}
</script>
</script>
<script>
function isValidStockFormat(data) {
	return (/^[0-9.]+([kmMnup][0-9]*)?(\[[a-z0-9.,]*\])?$/i).test(data);
}
function formatToValidStockFormat(data) {
	return data.replace(/(^|$)/g,' ').replace(/ [^0-9 ]+[^ ]* /,' ');
}
function remove_operators(data) {
	return data.replace(/(\(|\)|\+|\/\/)+/g," ").replace(/(\s)+/g," ").replace(/(^\s|\s$)/g,"");
}
function reformat_stock(v_stock) {
	var stock_parse_tab=formatToValidStockFormat(secureText(remove_operators(v_stock))).split(" ");
	var v_stock_hash={
	};
	var i;
	var k;
	var qte;
	for (i=0; (i <stock_parse_tab.length); i++) {
		k=stock_parse_tab[i];
		if (k.search('{')>0) {
			qte=parseInt(k.replace(/(.*\{)/,'').replace(/(\})/,''));
			k=k.replace(/(\{.*)/,'');
		} else {
			qte=1;
		}
		if (k in v_stock_hash) {
			v_stock_hash[k]=v_stock_hash[k]+qte;
		} else {
			v_stock_hash[k]=qte;
		}
	}
	v_stock="";
	delete v_stock_hash[''];
	for (k in v_stock_hash) {
		v_stock=v_stock.concat(correctValueFromDesc(k),"{",v_stock_hash[k],"} ");
	}
	return v_stock.replace(/(^\s|\s$)/g,"");
}
</script>
</script>
<script>
function ring_package_view(data){
	var tab_desc=get_tab_desc_in_desc(data);
	var mode=get_standard_mode(tab_desc);
	var span_base=["<span class='","'>&nbsp;&nbsp;</span> "];
	var cei_coloration=get_cei_color_tab(data);
	return "&mdash;" +
		htmlSpan( "&nbsp;" + 
			span_base[0] + cei_coloration[0] + span_base[1] +
			span_base[0] + cei_coloration[1] + span_base[1] +
			(mode>PKG_ID_TO_MODE['PACKAGE_RING']+1?span_base[0] + cei_coloration[2] + span_base[1]:"") +
			span_base[0] + cei_coloration[3] + span_base[1] +
			span_base[0] + cei_coloration[4] +span_base[1] +
			(mode==6?span_base[0]+'cei_color_None'+span_base[1]:"")+
			"&nbsp;" ,
			{ class:"resistor_view "+cei_coloration[5] }) + "&mdash;" ;
}
function electrolytic_capacitor_view(data){
	var value=splitValueNDesc(data)[0];
	return htmlSmall(
			htmlSpan(
				htmlSmall(
				htmlSpan('&nbsp;&nbsp;&nbsp;',
					{class:'eletrolytic_pkg_view_round cei_color_Silver'}
				) + htmlStrong('..')
				+ value + htmlStrong("..")
				)
				,
				{class:'eletrolytic_pkg_view_cylinder cei_color_Black'}
			)
	)	+
	htmlSpan("||",{class:'rotate_item_unvertical'});
}
function plastic_capacitor_view(data){
	var value=splitValueNDesc(data)[0];
	return htmlSpan(value,{class:'plastic_pkg_view cei_color_Blue'});
}
function ceramic_capacitor_view(data){
	var tab_desc=get_tab_desc_in_desc(data);
	return htmlSpan("&nbsp;"+get3DigitNotation(tab_desc)+"&nbsp;",
			{class:'eletrolytic_pkg_view_cylinder ceramic_color_Brown down_small_item'})+
			htmlDiv("|&nbsp;|",{});
}
function bobine_resistor_view(data){
	var tab_desc=get_tab_desc_in_desc(data);
	return "&mdash;" +
			htmlSpan("&nbsp;&nbsp;" +
					formatUnit(get_value_from_tab_desc(tab_desc)) + " " + tab_desc[5]
					+ "&nbsp;&nbsp;", {class : 'power_resistor_view'})
			+ "&mdash;";
}
function undefined_component(data){
	var value=splitValueNDesc(data)[0];
	return "&mdash;" +
			htmlSpan("&nbsp;&nbsp;"+data+"&nbsp;&nbsp;</span>",
					{class:'cei_color_Black'})
				+ "&mdash;";
}
</script>
</script>
<script>
function add_to_stock(data) {
	var t=(is_resistor(data)?'resistor':(is_capacitor(data)?'capacitor':''));
	if ( t != '' ){
		t='my_stock_'+t;
		htElem(t).value=htElem(t).value.concat(" ",data);	
	}
	updateStock();
}
function is_valid_stock(inputField) {
	var isValid = (/^(\s)*[0-9.]+([kmMnup][fFhH]?[0-9]*[fFhH]?)?(\[[a-z0-9.,]*\])?(\{[0-9]+\})?((\s)*[0-9.]+([kmMnup][fFhH]?[0-9]*[fFhH]?)?(\[[a-z0-9.,]*\])?(\{[0-9]+\})?)*(\s)*$/i).test(inputField.value);
	if (isValid) {
		inputField.style.backgroundColor = '#bfa';
	} else {
		inputField.style.backgroundColor = '#fba';
	}
	return isValid;
}
function reformat_input_stock() {
	htElem('my_stock_resistor').value=reformat_stock(htElem('my_stock_resistor').value);
	htElem('my_stock_capacitor').value=reformat_stock(htElem('my_stock_capacitor').value);
}
function make_view_from_formatted_stock(stock_txt_id,stock_view_id) {
	var stock_parse_tab=htElem(stock_txt_id).value.split(" ");
	var i;
	var k;
	var qte;
	var node=htElem(stock_view_id);
	while (node.hasChildNodes()) {
		node.removeChild(node.lastChild);
	}
	for (i=0; (i <stock_parse_tab.length); i++) {
		k=stock_parse_tab[i];
		qte=parseInt(k.replace(/(.*\{)/,'').replace(/(\})/,''));
		k=k.replace(/(\{.*)/,'');
		if (k!="") {
			node.appendChild(get_component_view(k,qte,stock_txt_id));
		}
	}
}
function makeViewFromFormattedTakenStock(node_id,source_txt_id,combinefuncset) {
	var node=htElem(node_id);
	while (node.hasChildNodes()) {
		node.removeChild(node.lastChild);
	}
	var formulas=new FormulaSet();
	formulas.populateFromTxt(htElem(source_txt_id).value);
	var h=formulas.getHash();
	for (k in h) {
		var value_min_max_tab=formulas.getMinMaxValues(k,combinefuncset);
		var formula_value=(value_min_max_tab[0]+value_min_max_tab[1])/2;
		formula_tol=Math.round((Math.abs(formula_value-value_min_max_tab[0])/formula_value)*100);
		add_to_taken_stock_view_resistor(k,"<em>=".concat(formula_value," (+/- ",formula_tol,"%) Ohm</em>"));
	}
}
function componentImgDiv(data_id,data_list,article_prop,figure_prop,caption_html,aside_html) {
	var div = document.createElement('tmp_div');
	var data;
	var tmp_html="";
	for (var i=0;i<data_list.length;i++) {
		data=data_list[i];
		if (data=="//") {
			tmp_html = tmp_html.concat("<br>");
		} else if (data=="(") {
			tmp_html = tmp_html.concat("<div class='resistor_inline'>");
		} else if (data==")") {
			tmp_html = tmp_html.concat("</div>");
		} else {
			tmp_html= tmp_html + (is_ring(data)?ring_package_view(data):
				(is_bobine_resistor(data)?bobine_resistor_view(data):
				(is_ceramic(data)?ceramic_capacitor_view(data):
				(is_plastic(data)?plastic_capacitor_view(data):
				(is_electrolytic(data)?electrolytic_capacitor_view(data):
				undefined_component(data))))));
		}
	}
	figure_prop['id']=data_id;
	div.innerHTML=htmlArticle(
		htmlFigure(tmp_html,caption_html,figure_prop) + aside_html,
	article_prop);
	return div;
}
function get_component_view(data,qte,input_id) {
	return componentImgDiv(
	/*id*/ data 
	/*components to show*/,[data] 
	/* article prop */,{class:'div_article'} 
	/* figure prop */,{class:'resistor_view_canvas', draggable:'true',
			ondragstart:"event.dataTransfer.setData('text','"+data+"')"}
	/* caption */,
		data + htmlSpan(htmlBig("&times; "+qte),
						{class:'shown_data', id:"qte"+data}) 
	/* aside */,
		htmlDiv(
		[
			htmlBtn(htmlLarge('+'),{onclick:"unblink();add_to_stock('"+data+"');"}),
			htmlBtn(htmlLarge((qte>1)?'-':'x'),
				{onclick:"popElemFromInputStock('"+data+"','"+input_id+"');",
				class:((qte>1)?null:'button_deprecated')})
			],
		{class:'div_button',
		onmouseover:"blink('qte"+data+"',0,'blink_data',200,'shown_data',500);",
		onmouseout:"unblink();"})
	);
}
function add_to_taken_stock_view_resistor(data,info) { //!TODO! affiche undefined, cf data/ 
	var formatted_caption=data.replace(
	/(\(.*)(\()/g, function(a,x,y) {return x+"<br>"+y;}).replace(
	/^(\()(.*)(\))$/g,function(a,b,x,c) {return x;}).replace(
	/(\(|\))/g,function(x) {return "&#8239;<small>"+x+"</small>&#8239;";}).replace(
	/(\/\/|\+)/g,function(x) {return "&#8239;<strong>"+x+"</strong>&#8239;";});
	
	htElem('taken_stock_view_resistor').appendChild(
	componentImgDiv(
	/*id*/ data
	/*components to show*/,data.match(/(\(|\)|\/\/|[a-z0-9.]+(\[[a-z0-9.,]*\])?)/ig)
	/* article prop */,{class:'resistor_view_canvas_resistor_small'}
	/* figure prop */,{class:' resistor_small', draggable:'true',
			ondragstart:"event.dataTransfer.setData('text','"+data+"')"}
	/* caption */,formatted_caption + 
		htmlSpan("<br>"+info,{class:'shown_data', id:data}) +
		htmlDiv([
		htmlBtn('Remettre',{onclick:"add_to_stock('"+data+"');taken_stock_remove('"+data+"');"}),
		htmlBtn('x',{onclick:"taken_stock_remove('"+data+"');",
				class:'button_deprecated'})
		],{})
	/* aside */,""
	)
	);
}
function updateStock() {
	reformat_input_stock();
	make_view_from_formatted_stock('my_stock_resistor','stock_view_resistor');
	make_view_from_formatted_stock('my_stock_capacitor','stock_view_capacitor');
}
function taken_stock_remove(formule) {
	htElem('my_stock_resistor_pris').value=htElem('my_stock_resistor_pris').value.replace(formule,"");
	makeViewFromFormattedTakenStock('taken_stock_view_resistor','my_stock_resistor_pris',combine_resistance);
}
function popElemFromInputStock(formule,input_id) {
	var grp_parse_tab=formule.replace(/[(+)]/g,function(x) {return ' '+x+' '}).replace(/(\s)+/g," ").split(" ");
	var i;
	var new_stock=htElem(input_id).value.replace(/(^|$)/g," ");
	var pos, pos2, pos3;
	var qte;
	var detailled_componant;
	var taken_stock="";
	for (i=0;i<grp_parse_tab.length;i++) {
		if ((grp_parse_tab[i]=='')||(grp_parse_tab[i]=='(')||(grp_parse_tab[i]==')')||(grp_parse_tab[i]=='+')||(grp_parse_tab[i]=='//')) {
			taken_stock=taken_stock.concat(grp_parse_tab[i]);
		} else {
			//~ console.log("|"+grp_parse_tab[i]+"|","|"+new_stock+"|");
			//check if stock still avaible
			pos=new_stock.indexOf(" "+grp_parse_tab[i]+"{");
			if (pos<0) {
				//obsolete : alternative checking : usefull if the formula doesn't contains details
				pos=new_stock.indexOf(" "+grp_parse_tab[i]+"\\[");
				if (pos<0) {
					//if not found, exit
					return "";
				}
				pos2=new_stock.indexOf("]",pos);
				if (pos2<0) {
					alert(new_stock.slice(pos,pos+grp_parse_tab[i].length+2), " est incomplet. Le format pour indiquer la référence est 'valeur[référence]'. ");
					return "";
				}
				detailled_componant=new_stock.slice(pos+1,pos2+1);
				taken_stock=taken_stock.concat(detailled_componant);
			} else {
				taken_stock=taken_stock.concat(grp_parse_tab[i]);
			}
			pos2=new_stock.indexOf("{",pos);
			pos3=new_stock.indexOf("}",pos2);
			qte=new_stock.substring(pos2+1,pos3);
			//~ console.log(qte,new_stock,pos,pos2,pos3);
			if (qte=="1") {
				new_stock=new_stock.substring(0,pos+1)+new_stock.substr(pos3+2);
			} else {
				new_stock=new_stock.substring(0,pos2+1)+(parseInt(qte)-1)+new_stock.substr(pos3);
			}
			//~ console.log(taken_stock,"<",new_stock);
		}
	}
	htElem(input_id).value=new_stock.replace(/(^\s|\s$)/g,"");
	
	updateStock();
	return taken_stock;
}
</script>
</script>
<script>
/*
 * 
 * Important note : this program use the concept of stock, 2 type of stock are used:
 *  	- simple stock represents the reserves
 *  	- computed stock represents all combinations possibles 
 *  Moreover the stock contains the value of the componants represented by the different formula (or set of componants) avaible :
 *      { "formula1" : {"componant1":qte,"componant2":qte}, "formula2" : {"componant3":qte,"componant2":qte} }
 *  So we have set of value associated to a set of set of componants.
 * 
 *  Here the structure of the stock concept.
 *    simple stock = { value1 : { "componant1" : {"componant1":qte}},
 *              	value2 : { "componant2" : {"componant2":qte}},... }
 *    computed stock = { value1 : { "formula1" : {"componant1":qte,"componant2":qte}},
 *              value2 : { "formula2" : {"componant1":qte,... }},"formula3" : {"componant1":qte,... }},... }
 * 
 * name: copyFormula
 * @param a formula e.g. {"componant1":qte,"componant2":qte}
 * @return a copy of the formula
 * 
 */
var ComponentsSet= function(components,nb) {
	
	this.qte=(typeof nb !== 'undefined')?nb:0;
	switch (typeof components){
		case 'undefined': this.components={}; break;
		case 'object': this.components=components; break;
		case 'string': this.components={}; this.components[components]=this.qte; break;
	}
	

	this.get= function(k){
		return this.components[k];
	}
		this.toString= function(){
		return '{ Components:' + hashToString(this.components) + ', #Components:' + this.qte + ' }';
	}
	this.addComponents= function(h){
		for (var v_k in h) {
			if (v_k in this.components) {
				this.components[v_k]=this.components[v_k]+h[v_k];
			} else {
				this.components[v_k]=h[v_k];
			}
			this.qte=this.qte+h[v_k];
		}
	}
	this.containsComponent= function(k){
		return k in this.components;
	}
	this.clone= function() {
		var components={};
		for (var v_k in this.components) {
			components[v_k]=this.components[v_k];
		}
		return new ComponentsSet(components,this.qte);
	}
	this.union= function(b) {
		var res=this.clone();
		res.addComponents(b.components);
		return res;
	}
	this.equal= function(b) {
		if (this.qte!=b.qte) {
			return false;
		}
		for (var v_k in this.components) {
			if ((!v_k in b.components) || (this.components[v_k]!=b.components[v_k])) {
				return false;
			}
		}
		return true;
	}
}
function RecomputeFormula(formula_txt,components_hash,funcset) {
	return parseFloat(parseAndCompute(
	formula_txt.replace(/(^|[ \(\/\+])([0-9.]+([kmMnup][0-9]*)?(\[[a-z0-9.,]*\])?)/ig,
	function(x,y,z) {
		return y.concat(components_hash[z]);
	}),funcset));
}
var FormulaSet= function (){
	this.formulas={};
	this.get= function(f_text) {
		return this.formulas[f_text];
	}
	this.getHash= function() {
		return this.formulas;
	}
	this.toString=function (){
		return '{ Formulas:' + hashToString(this.formulas) + ' }';
	}
	this.hash= function() {
		return this.formulas;
	}
	this.add= function(f_text,k) {
		if (!(f_text in this.formulas)) {
			this.formulas[f_text]=k;
		} else {
			this.formulas[f_text].addComponents(k.components);
		}
	}
	this.populateFromTxt= function(stock_txt){//TODO
		var i;var j;
		var k;
		var formula_txt;
		var formula_stock_txt;
		var formula_parse_tab;
		var stock_parse_tab=stock_txt.replace(
			/\(\s*/g,"(").replace(
			/\s*\)/g,")").replace(
			/\s*\+\s*/g,"+").replace(
			/\s*\/\/\s*/g,"//").split(" ");
		for (i=0; (i < stock_parse_tab.length); i++) {
			formula_txt=stock_parse_tab[i];
			if (formula_txt!=""){
				formula_parse_tab=reformat_stock(formula_txt).split(' ');
				for (j=0; (j < formula_parse_tab.length); j++) {
					k=formula_parse_tab[j];
					qte=parseInt(k.replace(/(.*\{)/,'').replace(/(\})/,''));
					this.add(formula_txt,new ComponentsSet(k.replace(/(\{.*)/,''),qte));
				}
			}
		}
	}
	this.clone= function(a) {
		var res={};
		for (var v_k in a) {
			res[v_k]=a[v_k].clone();
		}
		return new FormulaSet(formulas);
	}
	this.contains= function(a){
		for (var f in this.formulas) {
			if (a.equal(this.formulas[f])) {
				return true;
			}
		}
		return false;
	}
	this.limitTo= function(num) {
		var i=0;
		var nb_solution=[];
		for (var k in this.formulas) {
			nb_solution[i]=[this.formulas[k].qte,k];
			i++;
		}
		if (i>num) {
			nb_solution.sort(function(a,b) {return a[0]-b[0];});
			while (i>num) {
				delete this.formulas[nb_solution.pop()[1]];
				i--;
			}
		}
	}
	this.getMinMaxValues= function (formula_txt,combine_function_set){
		var min_val_component_set={};
		var max_val_component_set={};
		var tol;
		var val;
		var tab_desc;//TODO
		for (var c in this.formulas[formula_txt].components) {
			if (!(c in min_val_component_set)) {
				tol="";
				if (c.indexOf("[")>0) { 
					tab_desc=get_tab_desc_in_desc(c);
					tol=tab_desc[4];
				} 
				val=parseUnit(c);
				if (tol=="") {
					min_val_component_set[c]=val;
					max_val_component_set[c]=val;
				} else {
					min_val_component_set[c]=(val-(parseFloat(tol)*val));
					max_val_component_set[c]=(val+(parseFloat(tol)*val));
				}
			}
		}
		return [RecomputeFormula(formula_txt,min_val_component_set,combine_function_set),
		RecomputeFormula(formula_txt,max_val_component_set,combine_function_set)];
	}
}
var Stock=function(){
	this.qte=0;
	this.sets_of_formulas={};
	this.combine_register={};
	this.getHash= function(k){
		return this.sets_of_formulas[k].getHash();
	}
	this.toString= function(){
		return '{ Stock:' + hashToString(this.sets_of_formulas) + ', #Stock:' + this.qte + ' }';
	}
	this.add= function(v_k,f_text,f){
		if (!(v_k in this.sets_of_formulas)) {
			this.sets_of_formulas[v_k]=new FormulaSet();
		}
		this.sets_of_formulas[v_k].add(f_text,f);
	}
	this.populateFromTxt= function(stock_txt){
		var i;
		var v_nb;
		var v_k;
		var k;
		var qte;
		var stock_parse_tab=stock_txt.split(' ');
		for (i=0; (i < stock_parse_tab.length); i++) {
			k=stock_parse_tab[i];
			qte=parseInt(k.replace(/(.*\{)/,'').replace(/(\})/,''));
			k=k.replace(/(\{.*)/,'');
			this.qte=this.qte+qte;
			v_k=parseUnit(k);
			this.add(v_k,k,new ComponentsSet(k,qte));
		}
	}
	this.containsComponents=function(a) {
		var v;
		for (var k in a.components) {
			v=parseUnit(k);
			if (!(v in this.sets_of_formulas)  ||
				(a.components[k] > this.sets_of_formulas[v].get(k).get(k)) ) {
				return false;
			}
		}
		return true;
	}
	this.getComputableSet= function(){
		var v_k; var k; var i;//values to iterate
		var init_set=new Stock();
		for (v_k in this.sets_of_formulas) {
			if (init_set.qte < 32) {
				i=0;
				for (k in this.sets_of_formulas[v_k].hash()) {
					if (i<3) {// for better perfomance we limit the number of different resistor
						init_set.qte++;
						init_set.add(v_k,k,new ComponentsSet(k,1));
						i++;
					}
				}
			} else { break ; }
		}
		return init_set;
	}
	this.populateCombine=function (orig_stock,list_comb) {
		/* list_com=[{symbole:symb_combi,combinaison:func_combi,limit:func_test_optim},...] */
		var v;
		var symb_combi;var func_combi;var func_test_optim;
		var formula_txt;
		var formula;
		this.qte=orig_stock.qte;
		
		for (var n=0; n < list_comb.length; n++) {
			symb_combi=list_comb[n]['symbole'];
			func_combi=list_comb[n]['combinaison'];
			func_test_optim=list_comb[n]['limit'];
			this.combine_register[symb_combi]=func_combi;
			for (var h in this.sets_of_formulas) {
				for (var k in this.sets_of_formulas[h].hash()) {
					for (var i in this.sets_of_formulas) {
						for (var j in this.sets_of_formulas[i].hash()) {
							formula_txt='('+k+' '+symb_combi+' '+j+')';
							formula=this.sets_of_formulas[h].get(k).union(this.sets_of_formulas[i].get(j));
							//~ if ( !(formula.containsComponent(formula_txt)) ){
								v=roundRelative(func_combi(h,i),3);
								//~ console.log(v);
								if (func_test_optim(formula,v) &&
								(orig_stock.containsComponents(formula)) &&
								( !(v in this.sets_of_formulas) || !(this.sets_of_formulas[v].contains(formula)) )
								) {
									this.add(v,formula_txt,formula);
									this.sets_of_formulas[v].limitTo(3);
								}
							//~ }
						}
					}
				}
			}
		}
	}
	// functions to find bests results of combinations
	this.searchGroup= function(v_value,v_ecart) {
		var res=[];
		var i=0;
		var diff;
		var min_max_val_tab;
		var val;
		var tab_desc;
		var tol;
		for (var k in this.sets_of_formulas) {
			var diff=Math.abs(k - v_value );
			//~ console.log(k,diff,v_ecart);
			if (res.length == 5){ break ;}
			if ( diff <= v_ecart ) {
				for (var formula in this.sets_of_formulas[k].getHash()) {
					//~ console.log(k,stock[k],formula,v_ecart);
					if (formula.indexOf('[')>0) {
						min_max_val_tab=this.sets_of_formulas[k].getMinMaxValues(formula,this.combine_register);
						diff=Math.abs(min_max_val_tab[0] - v_value );
						var diff_max=Math.abs(min_max_val_tab[1] - v_value );
						if(diff<diff_max) {
							diff=diff_max;
						}
					}
					if ( diff <= v_ecart ) { 
						res[i]=[Math.round(k),formula,Math.round(diff)];
						i++;
					}
				}
			}
		}
		//~ console.log(res);
		res.sort(function(a, b) {return a[2]-b[2]})
		return res;
	}
}

if(LIB_UNITTEST_LOADED){
	var values={
		component1ktoStr:'{ Components:{1k:1}, #Components:1 }',
		stock1txt:"1k{1} 1k{1}",
		stock1toStr:'{ Stock:{1000:{ Formulas:{1k:{ Components:{1k:2}, #Components:2 }} }}, #Stock:2 }',
		stock1btoStr:'{ Stock:{1000:{ Formulas:{1k:{ Components:{1k:1}, #Components:1 }} }}, #Stock:1 }',
		stock2txt:"1k{2} 2k[2,,,1k,0.01]{2}",
		stock2ComputedtoStr:'{ Stock:{\
1000:{ Formulas:{1k:{ Components:{1k:1}, #Components:1 }} },\
2000:{ Formulas:{\
2k[2,,,1k,0.01]:{ Components:{2k[2,,,1k,0.01]:1}, #Components:1 },\
(1k + 1k):{ Components:{1k:2}, #Components:2 }\
} },\
3000:{ Formulas:{\
(1k + 2k[2,,,1k,0.01]):{ Components:{1k:1,2k[2,,,1k,0.01]:1}, #Components:2 }\
} },\
4000:{ Formulas:{\
(2k[2,,,1k,0.01] + 2k[2,,,1k,0.01]):{ Components:{2k[2,,,1k,0.01]:2}, #Components:2 }\
} }\
}, #Stock:4 }'
	};
	var prerequis={};
	var prerequis_function={
			formulas: function(mem){
				mem['formula1']=new ComponentsSet({'1k':1},1);
				mem['formula2']=new ComponentsSet({'1k':2},2);
				mem['formula3']=new ComponentsSet({'1k':3},3);
				return true;
			},
			populateStock1: function(mem){
				if (prerequis['formulas']){
					mem['stock']=new Stock();
					mem['stock'].populateFromTxt(values['stock1txt'],true);
					mem['stockb']=mem['stock'].getComputableSet();
					return true;
				} else {
					return false;
				}
			},
			populateStock2: function(mem){
				mem['stock']=new Stock();
				mem['stock'].populateFromTxt(values['stock2txt'],true);
				mem['stockb']=mem['stock'].getComputableSet();
				mem['stockb'].populateCombine(mem['stock'],
				[{  symbole:'+',
					combinaison:getValResistancesEnSerie,
					limit:function (f,v){return f.qte<=2;}
					}]);
				return true;
			},
			searchGroup1: function(mem){
				return prerequis['populateStock2'];
			}		
	};
	function prepare(a,v){
			if (! (a in prerequis) ){
				prerequis[a]=prerequis_function[a](v);
			}
			return prerequis[a];
	}
	function objEqual(a,b){return a.equal(b);}
	function objToString(a){return a.toString();}
	function objContainsComponents(a,b){return a.containsComponents(b);}
	function objSearchGroup(a,b,c){return a.searchGroup(b,c).toString();}
	tests=[
		{
		"Test formula 1a":{prerequis:'formulas',func:objEqual,res:false,
			args:function(v){return [v['formula1'],v['formula2']];}},
		"Test formula 1b":{prerequis:'formulas',func:objEqual,res:true,
			args:function(v){return [v['formula1'].union(v['formula2']),v['formula3']];}},
		"Test formula 1c":{prerequis:'formulas',func:objToString,res:values['component1ktoStr'],
			args:function(v){return [v['formula1']];}}
		},
		{
		"Test populate 1a":{prerequis:'populateStock1',func:objToString,res:values['stock1toStr'],
			args:function(v){return [v['stock']];}},
		"Test containsComponent 1a":{prerequis:'populateStock1',func:objContainsComponents,res:true,
			args:function(v){return [v['stock'],v['formula2']];}},
		"Test containsComponent 1b":{prerequis:'populateStock1',func:objContainsComponents,res:false,
			args:function(v){return [v['stock'],v['formula3']];}},
		"Test populate 1b":{prerequis:'populateStock1',func:objToString,res:values['stock1btoStr'],
			args:function(v){return [v['stockb']];}}
		},
		{
		"Test combine 1a":{prerequis:'populateStock2',func:objToString,res:values['stock2ComputedtoStr'],
			args:function(v){return [v['stockb'],v['formula2']];}},
		"Test search 1a":{prerequis:'searchGroup1',func:objSearchGroup,res:[1000,"1k",0],
			args:function(v){return [v['stockb'],1000,0];}},
		"Test search 1c":{prerequis:'searchGroup1',func:objSearchGroup,res:[1000,"1k",500],
			args:function(v){return [v['stockb'],1500,500];}},
		"Test search 1b":{prerequis:'searchGroup1',func:objSearchGroup,res:[3000,"(1k + 2k[2,,,1k,0.01])",20],
			args:function(v){return [v['stockb'],3000,100];}}
		}
		
	
	];
	var t;
	for (var i=0; i<tests.length;i++){
		for (t in tests[i]){
			if ( prepare(tests[i][t].prerequis,values) ){
				if ((typeof tests[i][t].func=='function') &&
					(typeof tests[i][t].args=='function') &&
					(typeof tests[i][t].res!='undefined')){					
					testFunction(tests[i][t].func,tests[i][t].args(values),
					tests[i][t].res,equal,t,Error("lib_stock_combine"));
				} else {
					console.log("'"+t+"' is not a valid test"); 
				}
			}
		}
	}
}
</script>
</script>
<script>
function dragResitorFromInput(ev,elem_input) {
	if ((elem_input.value!="")&&(isValidStockFormat(elem_input.value))) {
		ev.dataTransfer.setData("text", elem_input.value);
	}
}
function dragResitor(ev) {
	if (my_component.getValue()!="") {
		ev.dataTransfer.setData("text", my_component.getRef());
	}
}
function dropText(ev,funcdo,funccallback) {
	ev.preventDefault();
	var data = ev.dataTransfer.getData("text");
	funcdo(data);
	if (funccallback!=null) {
		funccallback(data);
	}
}
function dropOnStock(ev) {
	dropText(ev,add_to_stock,shake);
}
function allowDrop(ev) {
	ev.preventDefault();
}
</script>
</script>
<script>
function store_resistance() {
	t=PKG_CHAR_TO_ID[my_component.package];
	if (updateComponentValueView(true)) {
		shake(t);
		updateStock();
		shake(my_component.getRef());
	} else {
		hurt(t);
	}
}
function get_resistance(desc) {
	if (!(desc != null )){ 
		desc='['+
		htElem('desc_v0').value+','+
		htElem('desc_v1').value+','+
		htElem('desc_v2').value+','+
		htElem('desc_mult').value+','+
		htElem('desc_tol').value+','+
		htElem('desc_pkg').value+']';
	}
	var tab_desc=get_tab_desc_in_desc(desc);
	if (tab_desc.length>=5) {
		val_set(0,tab_desc[0]);
		val_set(1,tab_desc[1]);
		val_set(2,tab_desc[2]);
		mult_set(tab_desc[3]);
		tolerance_set(tab_desc[4]);
		if(/[wW]$/.test(tab_desc[5])){
			package_set('PACKAGE_BOBINE');
			pow_set(tab_desc[5].replace(/[wW]/,''));
		} else if (/[A-Z]/.test(tab_desc[5])){
			package_set('PACKAGE_RING');
			corps_set(PKG_COLOR_CHAR_TO_ID[tab_desc[5]]);
		} else if (/c/.test(tab_desc[5])){
			package_set('PACKAGE_CERAMIC');
		} else if (/e/.test(tab_desc[5])){
			package_set('PACKAGE_ELECTROLYTIC');
		}
		if(my_component.mode==''){
			my_component.autosetMode();
			mode_set(my_component.mode);//imply update value and delete useless values
		}
	} else {
		alert("Format de référence non reconnu");
	}
}
function run_get_resistance(event) {
	if (event.which == 13 || event.keyCode == 13) {
		get_resistance();
		return false;
	}
	return true;
}
function format_component_value_with_tolerance(val,lettre,unite) {
	if (my_component.tolerance > 0) {
		var tol=val*my_component.tolerance;
		val=formatUnit(val-tol) + ' <small>'+ unite +
		'</small> &le; ' + lettre +' &le; '+
		formatUnit(val+tol) +' <small>'+unite+'</small>';
	}
	else{
		val=lettre + '= ' +formatUnit(val) +' <small>'+ unite+'</small>';
	}
	return val;
}
function updateComponentValueView(do_store) {
	var desc=my_component.getDesc();
	var complete=my_component.isComplete();
	var measure_and_unit=my_component.getMeasureAndUnit();
	var component_stock_text=(my_component.type=='CAPACITOR')?'my_stock_capacitor':
	'my_stock_resistor';
	
	var add_btn_id='stock_add_btn';
	var add_btn_disabled_class='button_disabled';
	var val;
	htElem('component_desc').value=desc;
	if ( complete && do_store) {
		val=my_component.getRef();
		if (isValidStockFormat(val)) {
			htElem(component_stock_text).value=htElem(component_stock_text).value.concat(" ",val);
			return true;
		}
	} else {
		val=my_component.getValue();
		htElem('component_value').innerHTML=( val != "" )?(
		format_component_value_with_tolerance(val,measure_and_unit[0],measure_and_unit[1])):"?";
		htElem(add_btn_id).disabled=( !complete );
		htElem(add_btn_id).className=complete?'':add_btn_disabled_class;
	}
	return false;
}
function mode_to_prerequisite(val){
	var prereq={};
	var pim=PKG_ID_TO_MODE;
	var nb=pim['PACKAGE_RING'];
	prereq['mult']=true;
	prereq['tol']=true;
	prereq['nb_ring']=(val>=nb);
	prereq['pkg_color']=(val>=nb); 
	prereq['value0']=true; 
	prereq['value1']=((val>=(nb+1))||(val<nb));
	prereq['value2']=((val>=(nb+2))||(val<nb) && (val!=pim['PACKAGE_CERAMIC']));
	prereq['ppm']=(val>=(nb+3));
	prereq['pow']=(val==pim['PACKAGE_BOBINE']);
	prereq['view_ppm']=(val>=(nb+3));
	return prereq;
}
function mode_set(val) {;
	my_component.setMode(val);
	var prereq=mode_to_prerequisite(val);
	for (var k in prereq){
		setVisible(k,prereq[k]);
	}
	if (prereq['nb_ring']) {
		if (my_component.type=='CAPACITOR'){
			corps_set('CAPACITOR_PINK');
		} else {
			corps_set('RESISTOR_CARBON');
		}	
		if (!(prereq['ppm'])) {	setClass('view_ppm',"cei_color_None");
			if (!(prereq['value2'])) {	setClass('view_value2',"cei_color_None");
							my_component.setValue(2,'');
				if (!(prereq["value1"])) {	setClass('view_value1',"cei_color_None");
								my_component.setValue(1,'');
				}
			}
		}
		val=val-PKG_ID_TO_MODE['PACKAGE_RING']+3;
		switchClass(['NBANNEAUX'+val],'active',last_button['NBANNEAUX']);
		last_button['NBANNEAUX'][0]='NBANNEAUX'+val;
	}
	updateComponentValueView();
}
function val_set(n,val){
	if (val!=null){
	var new_last_button=[];
	setClass('view_value'+n, color_tab_val[val]);
	setInputValue('desc_v'+n,val);
	if (my_component.package==PKG_ID_TO_CHAR['PACKAGE_RING']) {
		mode_set(PKG_ID_TO_MODE[val]+n);
	}
	my_component.setValue(n,val);
	if ( (val + "") != "" ){
		new_last_button[0]='VAL'+n+'_'+val;
	}
	switchClass(new_last_button,'active',last_button['VAL'+n]);
	last_button['VAL'+n]=new_last_button;
	updateComponentValueView();
	}
}
function mult_set(val) {
	if (val!=null){
	setClass('view_mult',color_tab_mult[val]);
	setInputValue('desc_mult',val);
	my_component.setMult(val);
	switchClass(['MULT'+val],'active',last_button['MULT']);
	last_button['MULT'][0]='MULT'+val;
	updateComponentValueView();
	}
}
function tolerance_set(val) {
	if (val!=null){
	setClass('view_tol',color_tab_tolerance[val]);
	setInputValue('desc_tol',val);
	my_component.setTolerance(val);
	switchClass(['TOLERANCE'+val],'active',last_button['TOLERANCE']);
	last_button['TOLERANCE'][0]='TOLERANCE'+val;
	updateComponentValueView();
	}
}
function pow_set(val) {
	if (val!=null){
	my_component.setPower(val+'W');
	setInputValue('desc_pkg',val+'W');
	var tmpid='POW'+val;
	switchClass([tmpid],'active',last_button['POW']);
	last_button['POW'][0]=tmpid;
	updateComponentValueView();
	}
}
function package_set(val) {
	if (val!=null){
	my_component.setPackage(PKG_ID_TO_CHAR[val]);
	translateContents('MULT',PKG_ID_TO_CONTENTS_MULT[val]);
	if (val=='PACKAGE_RING') {
		mode_set(PKG_ID_TO_MODE[val]+
		(my_component.value[1]+""+my_component.value[2]).length);
	} else {
		mode_set(PKG_ID_TO_MODE[val]);
		my_component.setType(PKG_ID_TO_TYPE_DEF[val]);
		my_component.setCorps(PKG_ID_TO_CHAR[val]);
		if (val!='PACKAGE_BOBINE') {
			setInputValue('desc_pkg',PKG_ID_TO_CHAR[val]);
		}
	}
	switchClass([val],'active',last_button['PACKAGE']);
	last_button['PACKAGE'][0]=val;
	updateComponentValueView();
	}
}
function corps_set(val) {
	if (val!=null){
	htElem('resistor_body').className="resistor_view "+color_tab_corps[val];
	my_component.setType(val.match(/^(CAPACITOR|RESISTOR)/)[0]);
	my_component.setCorps(PKG_COLOR_ID_TO_CHAR[val]);
	
	setInputValue('desc_pkg',PKG_COLOR_ID_TO_CHAR[val]);
	switchClass([val],'active',last_button['PKG_COLOR']);
	last_button['PKG_COLOR'][0]=val;
	updateComponentValueView();
	}
}
function ppm_set(val,view_class) {
	if (val!=null){
	htElem('view_ppm').className=view_class;
	}
}
function init_decoder_tool() {
	var elems;
	var elem;
	var val;
	var tab_fill;
	var i, j, k, val;
	tab_fill=['value0','value1','value2','mult','tol','ppm']
	for (i=0, length = tab_fill.length; i<length; i++){
		//~ console.log(tab_fill[i]);
		elem=htElem(tab_fill[i]);
		htSetClassOnEvents(elem,'border_view_'+tab_fill[i],
		{onmouseover:'resistor_blink_val',onmouseout:'resistor_blink_val_hidden'});	
		elem=htElem('border_view_'+tab_fill[i]);
		elem.className='resistor_blink_val_hidden';
		htSetHover(elem,tab_fill[i],"{parent:'highlight'}");		
		setClass('view_'+tab_fill[i],'cei_color_None');
		setInnerHTML('view_'+tab_fill[i],'&nbsp;');
	}
	elems=document.getElementsByName('PKG_COLOR');
	last_button['PKG_COLOR']=[];
	for (i = 0, length = elems.length; i < length; i++) {
		elems[i].className=color_tab_corps[elems[i].id];
		elems[i].setAttribute('onClick','corps_set("'+elems[i].id+'")');
	}
	elems=document.getElementsByName('PACKAGE');
	last_button['PACKAGE']=[];
	for (i = 0, length = elems.length; i < length; i++) {
		elems[i].setAttribute('onClick','package_set("'+elems[i].id+'")');
	}
	
	last_button['NBANNEAUX']=[];
	htElem('nb_ring').innerHTML=htmlMatrix(
		[['title',3,4,5,6]],
		'ul',
		{ 	title : '<li class="title">'+htElem('nb_ring').title+'</li>',
			default : function(elt){
				return '<li id="NBANNEAUX'+elt+'" onClick="mode_set('+
				(PKG_ID_TO_MODE['PACKAGE_RING']+(elt-3))+')" >'+ elt+'</li> ';
				
			}
		}
	 );
	
	
	last_button['MULT']=[];
	htElem('mult').innerHTML=htmlMatrix(
		[[0,1,4,7,],[-1,2,5,'x'],[-2,3,6,'x']],
		'ul',
		{ x:'<li onClick="mult_set(1)">&nbsp;</li>',
		  default : function(elt){
				var val=Math.pow(10,elt);
				return '<li class="'+color_tab_mult[val]+
				'" id="MULT'+val+
				'" onClick="mult_set('+val+')" title="x'+formatUnit(val)+'" >'+
				elt+'</li> ';
			}
		}
	 );
	last_button['TOLERANCE']=[];
	htElem('tol').innerHTML=htmlMatrix(
		[[0.01,0.001,0.05],[0.02,0.0025,0.1],[0,0.005,0.2]],
		'ul',
		{ 0:'<li id="TOLERANCE0" onClick="tolerance_set(0)">&nbsp;</li>',
		  default : function(elt){
				return '<li id="TOLERANCE'+elt+
		'" class="'+color_tab_tolerance[elt] +
		'" onClick="tolerance_set('+elt+')">&nbsp;'+ 
		((elt*100)+"").replace(/0(\.[0-9][0-9])/,function(a,b){return b;}) +
		'&nbsp;</li> ';
			}
		}
	);
	last_button['POW']=[];
	htElem('pow').innerHTML=htmlMatrix(
		[[1,2,2.5,3,4],[5,7,11,12,20],[25,30,50,90,100],[180,250,300]],
		'ul',
		{ x:'<li>&nbsp;</li>',
		  default : function(elt){
				return '<li id="POW'+elt+'" onClick="pow_set('+elt+')">'+elt+'</li>';
			}
		 }
	);
	
	for (var j=0 ; j<3 ; j++ ){
		last_button['VAL'+j]=[];
		
		htElem('value'+j).innerHTML=htmlMatrix(
			[[0,1,4,7,],['x',2,5,8],['x',3,6,9]],
			'ul',
			{ x:'<li onClick="val_set('+j+',\'\')">&nbsp;</li>',
			default : function(elt){
				return '<li class="'+color_tab_val[elt]+
				'"id="VAL'+j+'_'+elt+
				'" onClick="val_set('+j+','+elt+')">'+
				elt+'</li> ';
			}
			});
	}
	package_set('PACKAGE_RING');
}
//memory for last activated buttons
var last_button={};
//current component desc
var my_component=new ComponentDesc();
//init graphical elements
init_decoder_tool();
</script>
</script>
<script>
<!-- functions in gui -->
function start_calcul_combinaisons() {
	setTimeout(function() {
		document.getElementById('button_chercher').className='button_hidden';
		document.getElementById('button_chercher_loading').innerHTML='Recherche en cours...';
		document.getElementById('button_chercher_loading').className='button_waiting';
	},0);
	setTimeout(function() {
		trouver_solutions();
		setTimeout(function() {
			document.getElementById('button_chercher').className='';
			document.getElementById('button_chercher_loading').className='button_hidden';
		},100);
	},100);
}
function trouver_solutions() {
	var v_resistance=parseInt(htElem('resistance').value);
	var v_ecart_type=parseFloat(htElem('ecart').value)/100;
	var v_ecart=v_ecart_type*v_resistance;
	var v_max=v_resistance+v_ecart;
	var v_min=v_resistance-v_ecart;
	var max_qte=parseInt(htElem('nbresistances').value);
	// reinitialization of the output
	var i;
	reformat_input_stock();// include quantification between { }
	for (i=1; i<(3+1);i++) {
		document.getElementById('grp_resistance'+i).value="";
		document.getElementById('grp_resistance_val'+i).innerHTML="";
		document.getElementById('prendre_grp'+i+'_btn').className="button_hidden";
	}
	// search the nearests
	var stock=new Stock();
	stock.populateFromTxt(document.getElementById('my_stock_resistor').value,true);
	var computed_stock=stock.getComputableSet();
	// build combinations
	var liste_combinaisons=[
		{symbole:'+', combinaison:getValResistancesEnSerie,
			limit:function(f,v){
				return (v < (v_resistance * 2)) && (f.qte<=max_qte);
				}
		},
		{symbole:'//', combinaison:getValResistancesEnParallel,
			limit:function(f,v){
				return (v < v_max) && (v > v_resistance/4)
				&& (f.qte<=max_qte);
				}
		},
		{symbole:'+', combinaison:getValResistancesEnSerie,
			limit:function(f,v){
				return (v < v_max) && (v>v_min) && (f.qte<=max_qte);
				}
		}
		];
	computed_stock.populateCombine(stock,liste_combinaisons);
	var v_solution=computed_stock.searchGroup(v_resistance,v_ecart);
	//~ console.log(v_solution);
	// displaying results
	for (i=0; i<((v_solution.length<3)?v_solution.length:3);i++) {
		document.getElementById('prendre_grp'+(i+1)+'_btn').className="";
		document.getElementById('grp_resistance'+(i+1)).value=v_solution[i][1];
		document.getElementById('grp_resistance_val'+(i+1)).innerHTML='='.concat(v_solution[i][0],
		' (+/- ',
		Math.round((v_solution[i][2]/v_solution[i][0])*10000)/100,"%)") ;
	}
}
function prendre_grp(n) {
	document.getElementById('my_stock_resistor_pris').value=document.getElementById('my_stock_resistor_pris').value.concat(" "
	,popElemFromInputStock(document.getElementById('grp_resistance'+n).value,'my_stock_resistor')
	).replace(')(',') (');
	
	//~ document.getElementById('grp_resistance'+n).value="";
	//~ document.getElementById('grp_resistance_val'+n).innerHTML="";
	for (var i=1; i<=3; i++){
		document.getElementById('prendre_grp'+i+'_btn').className="button_hidden";
	}
	makeViewFromFormattedTakenStock('taken_stock_view_resistor','my_stock_resistor_pris',combine_resistance);
}
</script>
</script>
<script>
document.getElementById('resistance_link').value=document.getElementById('resistance').value;

function calcul_puissance() {
	setTimeout(function(){
		do_calcul_puissance();
	},0);
}

function do_calcul_puissance() {
	var v_U=parseUnit(document.getElementById('tension').value);
	var v_R=parseUnit(document.getElementById('resistance_link').value);
	var v_P=(v_U*v_U)/v_R;
	var msg="ndef";
	if (v_P>=1) {
		msg="Attention : seul des resistances de puissance".concat(((v_P>=3)?" bobinées ":" "),"peuvent supporter plus de ",((v_P>=3)?3:1), "W !");
	} else if (v_P>=0.5) {
		msg="Attention : il faut utiliser des résistances haute tension ou des résistances de puissance pour supporter plus de 0,5W !";
	} else {
		msg="Note : les résistances métalliques (bleu ou vert) génèrent moins de bruit que des résistances carbone (marron).";
	}
	document.getElementById('puissance').value=Math.round(v_P*1000)/1000;
	document.getElementById('indication_puissance').innerHTML=msg;
}
</script>
</script>
<script>
function mini_calc_resistance() {
	var user_input=document.getElementById('calc_in_resistance').value.replace(
	/[abcdfghijloqrstvwxyzABCDEFGHIJKLNOPQRSTUVWXYZ]+[a-zA-Z]*/g,'');
	document.getElementById('calc_out_resistance').innerHTML=formatUnit(
	parseAndCompute(user_input,combine_resistance),true);
}
function mini_calc_capacitance() {
	var user_input=document.getElementById('calc_in_capacitance').value.replace(
	/[abcdfghijloqrstvwxyzABCDEFGHIJKLNOPQRSTUVWXYZ]+[a-zA-Z]*/g,'');
	while (/(e[0-9]+)([^Mkmnup]|$)/.test(user_input)) { // unite standard : picofarad
		user_input=user_input.replace(/(^|[^0-9])([0-9]+e[0-9]+)([^Mkmnup]|$)/g,
		function (a,b,c,d) {
			return b + c + "p" + d;
		});
	}
	document.getElementById('calc_out_capacitance').innerHTML=formatUnit(
	parseAndCompute(user_input,combine_capacitance),true);
}
</script>
</script>
<script>
document.getElementById('ecart_link').value=document.getElementById('ecart').value;
document.getElementById('nbresistances_link').value=document.getElementById('nbresistances').value;
function cherche_div_tension() {
	setTimeout(function() {
			document.getElementById('btn_cherche_div_tension').className='button_hidden';
			document.getElementById('btn_cherche_div_tension_loading').innerHTML='Recherche en cours...';
			document.getElementById('btn_cherche_div_tension_loading').className='button_waiting';
		},0);
	setTimeout(function() {
		calcul_div_tension();
		setTimeout(function() {
			document.getElementById('btn_cherche_div_tension').className='';
			document.getElementById('btn_cherche_div_tension_loading').className='button_hidden';
		},100);
	},100);
}
function cherche_div_tension_stock() {
	setTimeout(function() {
			document.getElementById('btn_cherche_div_tension_stock').className='button_hidden';
			document.getElementById('btn_cherche_div_tension_stock_loading').innerHTML='Recherche en cours...';
			document.getElementById('btn_cherche_div_tension_stock_loading').className='button_waiting';
		},0);
	setTimeout(function() {
		calcul_div_tension();
		setTimeout(function() {
			document.getElementById('btn_cherche_div_tension_stock').className='';
			document.getElementById('btn_cherche_div_tension_stock_loading').className='button_hidden';
		},100);
	},100);
}
// Equation (without charge) :
//Us=Ue*(R2)/(R1+R2) ->
//Us/R2=Ue/(R1+R2) ->
//R2/U2=(R1+R2)/Ue ->
//R2=(R1+R2)Us/Ue ->
//R2-(R2*Us/Ue)=R1*Us/Ue ->
//R2*Ue/Us - R2 = R1 -> R1 !!!
//R2*(Ue/Us - 1) = R1 ->
//R2= R1/(Ue/Us - 1) -> R2 !!!
// with charge : sub R2 by R2' = (R2 // Rs) (we can compute R2')
function calcul_div_tension() {
	var v_entree=parseUnit(document.getElementById("t_in").value);
	var v_sortie=parseUnit(document.getElementById("t_out").value);
	var r_entree=parseUnit(document.getElementById("charge_in").value);
	var r_sortie=parseUnit(document.getElementById("charge_out").value);
	var rs_influence=getCheckedElementByName(document,"influence_percent").value;
	// reinitialization of the output
	var v_solution=[];
	var v_r1=-1;
	var v_r2=0;
	var v_r2rl;
	var r=Math.round(rs_influence*(r_sortie+r_entree)/100);
	var r_round=(r>10000)?1000:((r>1000)?100:((r>100)?10:1));
	r=(Math.round(r/r_round)*r_round);
	while ((v_r1<0) && (r>0)) {
		//R1 + Re  = (R2 // Rs)*Ue/Us - (R2 // Rs)
		v_r2=r;
		v_r2rl=getValResistancesEnParallel(v_r2,r_sortie);
		v_r1=Math.round((((v_r2rl*v_entree)/v_sortie)-v_r2rl)-r_entree);
		r=r-r_round;
	}
	if (v_r1>0) {
		//solution avec forte influence de Rs...
		document.getElementById("solution_div_tension").innerHTML="".concat(
		"<strong>R1</strong>"," = ",formatUnit(v_r1),"<br>",
		"<strong>R2</strong>"," = ",formatUnit(v_r2));
		shake("solution_div_tension");
	} else {
		document.getElementById("solution_div_tension").innerHTML="Pas de solution trouvée. Essayez de faire varier l'influence de Rs.";
	}
	return false;
}
function calcul_div_tension_stock() {
	var v_entree=parseUnit(document.getElementById("t_in").value);
	var v_sortie=parseUnit(document.getElementById("t_out").value);
	var r_entree=parseUnit(document.getElementById("charge_in").value);
	var r_sortie=parseUnit(document.getElementById("charge_out").value);
	var rs_influence=getCheckedElementByName(document,"influence_percent").value;
	var stock={
	};
	var stock_parse_tab=document.getElementById('my_stock_resistor').value.split(" ");
	var max_qte=parseInt(document.getElementById('nbresistances').value);
	var ecart=parseFloat(document.getElementById('ecart').value);
	var v_tolerance;
	// reinitialization of the output
	reformat_input_stock();// include quantification between { }
	var comb_final_set=calcul_combinaisons(max_qte);
	var v_solution=[];
	var v_r1;
	var v_r2;
	var v_r2rl;
	var v_solution_r;
	var r_virtual=Math.round(rs_influence*(r_sortie+r_entree)/100);
	var r_virtual_round=(r>10000)?1000:((r>1000)?100:((r>100)?10:1));
	var r_min=r_virtual-(r_virtual_round)*10;
	var r_max=r_virtual+(r_virtual_round)*10;
	for (var r in comb_final_set) {
		if ((r > r_max) || (r < r_min)) {continue;}
		v_tolerance=(ecart*r)/100;
		//R1' = R2'*U/U2 - R2'
		//  R1' = (R1 + Re)      R2' = (R2 // Rs)
		v_r2rl=getValResistancesEnParallel(r,r_sortie);
		v_r1=(((v_r2rl*v_entree)/v_sortie)-v_r2rl)-r_entree;
		if ((v_r1<0)) {continue;}
		//~ console.log(r,v_entree,v_sortie,v_r1);
		v_solution_r=SearchGroup(r,v_tolerance,comb_final_set);
		if (v_solution_r.length>0) {
			//check if the tolerance for the current resistor is enough
			v_solution=SearchGroup(v_r1,v_tolerance,comb_final_set);
			if (v_solution.length>0) {
				document.getElementById("solution_div_tension").innerHTML="".concat(
				"<strong>R1</strong>"," = ",formatUnit(r)," = ",v_solution_r[0][1],"<br>",
				"<strong>R2</strong>"," = ",formatUnit(Math.round(v_r1))," = ",v_solution[0][1]);
				shake("solution_div_tension")
				return true;
			}
		}
	}
	document.getElementById("solution_div_tension").innerHTML="Pas de solution trouvée en fouillant dans le stock. Essayez de faire varier l'influence de Rs.";
	return false;
}
var c=document.getElementById("monCanvas");
var canvOK=1;
try {c.getContext("2d");}
catch (er) {canvOK=0;}
if (canvOK==1) {
	var ctx=c.getContext("2d");
	var x=0;
	var y=0;
	ctx.fillStyle="black";
	ctx.font="10px Sans-Serif";
	ctx.beginPath();
	ctx.moveTo(30,y+10);
	ctx.lineTo(30,y+20);
	ctx.strokeRect(20,y+20,20,40);
	ctx.moveTo(30,y+60);
	ctx.lineTo(30,y+70);
	ctx.moveTo(20,y+70);
	ctx.lineTo(40,y+70);
	ctx.moveTo(25,y+80);
	ctx.lineTo(35,y+80);
	ctx.moveTo(30,y+80);
	ctx.lineTo(30,y+130);
	ctx.moveTo(30,y+10);
	ctx.lineTo(85,y+10);
	ctx.lineTo(85,y+20);
	ctx.strokeRect(75,y+20,20,40);
	ctx.moveTo(85,y+60);
	ctx.lineTo(85,y+80);
	ctx.moveTo(85,y+70);
	ctx.lineTo(135,y+70)
	ctx.moveTo(85,y+130);
	ctx.strokeRect(75,y+80,20,40);
	ctx.moveTo(85,y+120);
	ctx.lineTo(85,y+130)
	ctx.moveTo(30,y+130);
	ctx.lineTo(135,y+130);
	ctx.strokeRect(170,y+80,20,40);
	ctx.moveTo(180,y+80);
	ctx.lineTo(180,y+70)
	ctx.lineTo(145,y+70);
	ctx.moveTo(180,y+120);
	ctx.lineTo(180,y+130)
	ctx.lineTo(145,y+130);
	ctx.stroke();
	ctx.fillText ("Re", 25, y+30); 
	ctx.fillText ("R1", 80, y+30); 
	ctx.fillText ("R2", 80, y+90);
	ctx.fillText ("Rs", 175, y+90);
	//tensions
	ctx.fillStyle="green";
	ctx.strokeStyle=ctx.fillStyle;
	ctx.beginPath();
	ctx.moveTo(125,y+85);
	ctx.lineTo(125,y+120);
	ctx.stroke();
	ctx.beginPath();
	ctx.moveTo(125,y+80);
	ctx.lineTo(120,y+85);
	ctx.lineTo(130,y+85);
	ctx.fill();
	ctx.fillText ("Us", 130, y+105);
	ctx.beginPath();
	ctx.moveTo(60,y+25);
	ctx.lineTo(60,y+120);
	ctx.stroke();
	ctx.beginPath();
	ctx.moveTo(60,y+20);
	ctx.lineTo(55,y+25);
	ctx.lineTo(65,y+25);
	ctx.fill();
	ctx.fillText ("Ue", 40, y+80);
}
</script>
</script>
<script>
//~ if(LIB_UNITTEST_LOADED){areUnitTestsOk();}
updateStock();
makeViewFromFormattedTakenStock('taken_stock_view_resistor','my_stock_resistor_pris',combine_resistance);

</script>
</script> <!--uncomment and edit this for testing-->

<script>
//~ console.log("Testing actions");
//~ document.getElementById("my_stock_capacitor").value="\
//~ 21n[2,1,,1k,0.01,P]{2} 1uf[1,,,1M,0.01,G] 1uf[1,,,1M,0.01,c] 1uf[1,,,1M,0.01,p] 1uf[1,,,1M,0.01,e]";
//~ document.getElementById("my_stock_resistor").value="\
//~ 21k[2,1,,1k,0.01,C]{2} 1k[1,,,1k,0.01,B] 10k[1,0,,1k,0.01,V]{2}\
 //~ 20k[2,0,,1k,0.01,R] 7k[7,,,1k,0.01,R] 9k[9,,,1k,0.01,R] 10500[1,0,5,100,0.01,C]{1}";
//~ updateStock();


document.getElementById("nav_mini_calc").click();

//~ document.getElementById("nav_block_stock_capacitor").click();

//~ document.getElementById("nav_resistor_decoder").click();

//~ setTimeout(function (){
	//~ document.getElementById("power_resistor_desc").click();
	//~ document.getElementById("VAL0_1").click();
	//~ document.getElementById("VAL1_0").click();
	//~ document.getElementById("MULT1").click();
	//~ document.getElementById("TOLERANCE0").click();
	//~ document.getElementById("POW1").click();
	//~ document.getElementById("stock_add_btn").click();
	//~ },10);
//~ document.getElementById("nav_block_stock_resistor").click();


//~ setTimeout(function (){
	//~ document.getElementById("nav_calc_combi_resistance").click();
	//~ document.getElementById("resistance").value=5000;
	//~ document.getElementById("button_chercher").click();
//~ },0 );
//~ setTimeout(function (){
	//~ document.getElementById("prendre_grp1_btn").click();	
//~ }, 1000);
//~ setTimeout(function (){
	//~ document.getElementById("nav_diviseur_tension").click();	
	//~ document.getElementById("btn_cherche_div_tension").click();
//~ 
//~ }, 2000);
//~ setTimeout(function (){	
	//~ document.getElementById("btn_cherche_div_tension_stock").click();
//~ }, 3000);
//~ 
//~ setTimeout(function (){
	//~ document.getElementById("nav_resistor_decoder").click();
		//~ document.getElementById("component_desc").value="1,2,0,10k,0.01,";
//~ },4000);
//~ 
</script>
</script>
</div>
</body>
</html>
